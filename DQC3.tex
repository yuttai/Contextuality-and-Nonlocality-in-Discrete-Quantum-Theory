%% Discrete Quantum Computing/Discrete Quantum Theory
%%  - third paper, focusing on how fundamental aspects needed by
%% all quantum mechanical theories (as treated in Asher Peres's book)
%% have to be approached in a quantum theory based on Galois groups,
%% via COMPUTABLE integer number fields with finite characteristic.

\documentclass[english,12pt]{iopart}
\usepackage{mathrsfs}
\usepackage{fullpage}
\usepackage{url}
\usepackage{times}
\usepackage{amstext}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{iopams}
\usepackage{setstack}

\input{Qcircuit}

\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
\usepackage{enumitem}		% customizable list environments
% \newlength{\lyxlabelwidth}      % auxiliary length 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\usepackage{amsfonts}
\usepackage{color}
\usepackage{stmaryrd}\usepackage{dsfont}
\usepackage[usenames,dvipsnames]{xcolor}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% these went missing?
% \newcommand{\bra}[1]{\left\langle{#1}\right|}
% \newcommand{\ket}[1]{\left|{#1}\right\rangle}
% \newcommand{\mathscr}[1]{{\cal #1}}
%\renewcommand{\author}[1]{\bf #1 \/}
\newcommand{\affiliation}[1]{\parbox{5.5in}{\small{\it #1 \/}}}

\newcommand{\cardp}[2]{#1 \,\sslash\, #2}
\newcommand{\braket}[2]{\langle{#1}|{#2}\rangle} 
\newcommand{\uf}{U_{\!f}}
\def\image {\rm Image~}
\def\ker{\rm ker~}
\def\coker{\rm coker~}
\def\ker{\rm ker~}
\def\dr{\smash{\downharpoonright}}
\def\ad{{\rm ad~}}
\def\Q{{\mathbb{Q}}}
\def\R{{\mathbb{R}}}
\def\N{{\mathbb{N}}}
\def\C{{\mathbb{C}}}
\def\Z{{\mathbb{Z}}}
\def\del{\partial}
\def\grad{\nabla}
\def\proof{{\em Proof:  }}
\def\ra{\rangle}
\def\la{\langle}
\def\rl{\rangle \langle}
\def\openone{\leavevmode\hbox{\small1\kern-3.8pt\normalsize1}}
\def\RR{{\rm I\kern-.2emR}}
\def\tr{{\rm tr}\; }
\def\fu{\mathfrak{u}}
\def\fa{\mathfrak{a}}
\def\fd{\mathfrak{d}}
\def\fb{\mathfrak{b}}
\def\fj{\mathfrak{j}}
\def\fg{\mathfrak{g}}
\def\fh{\mathfrak{h}}
\def\fk{\mathfrak{k}}
\def\fs{\mathfrak{s}}
\def\fgl{\mathfrak{gl}}
\def\fsl{\mathfrak{sl}}
\def\fsu{\mathfrak{su}}
\def\fsp{\mathfrak{sp}}
\def\fso{\mathfrak{so}}
\def\proof{{\em Proof:  }}
\def\tphi{\tilde{\Phi}}
\def\ra{\rangle}
\def\la{\langle}
\def\rl{\rangle \langle}
\def\openone{\leavevmode\hbox{\small1\kern-3.8pt\normalsize1}}
\def\RR{{\rm I\kern-.2emR}}
\def\tr{{\rm tr}\; }
\def\ce{{\cal E}}
\def\cl{{\cal L}}
\def\cg{{\cal G}}
\def\cd{{\cal D}}
\def\cb{{\cal B}}
\def\cn{{\cal N}}
\def\ch{{\cal H}}
\def\cs{{\cal S}}
\def\ct{{\cal T}}
\def\cp{{\cal P}}
\def\cm{{\cal M}}
\def\cf{{\cal F}}
\def\ci{{\cal I}}
\def\ca{{\cal A}}
\def\calr{{\cal R}}
\def\cv{{\cal V}}
\def\cc{{\cal C}}
\def\rhon{\rho^{\otimes n}}
\def\on{^{\otimes n}}
\def\pn{^{(n)}}
\def\pnp{^{(n)'}}
\def\id{\frac{I}{d}}
\def\pthang{\frac{P}{\sqrt{d \tr P^2}}}
\def\Psirq{\Psi^{RQ}}
\def\d{^\dagger}
\def\union{\cup}
\def\intersection{\cap}
\newcommand{\QED}{\hspace*{\fill}\mbox{\rule[0pt]{1.5ex}{1.5ex}}}
\providecommand{\ignore}[1]{}

\newcommand{\scalarZ}{0}
\newcommand{\scalarO}{1}
\newcommand{\scalarPlus}{+}
\newcommand{\scalarTimes}{*}
\newcommand{\ip}[2]{\langle #1 ~|~ #2 \rangle}
\newcommand{\usat}{\texttt{UNIQUE-SAT}}
\newcommand{\boolt}{\textsf{Bool}} 
\newcommand{\bfalse}{\texttt{\textbf{false}}}
\newcommand{\btrue}{\texttt{\textbf{true}}}
\newcommand{\ff}[1]{\mathbb{F}_{#1}}
\newcommand{\ffz}[1]{{\mathbb{F}^{\ast}_{#1}}}
%% \newcommand{\ffzd}[1]{\mathbb{F^{d}}_{#1}^{*}}
%%\newcommand{\ffzd}[1]{{\mathbb{F}^{d}_{#1}}^{\ast}}
%%\newcommand{\ffzd}[1]{{\mathbb{F}^{d\,\ast}_{#1}}}
\newcommand{\ffd}[1]{{\mathbb{F}^{d}_{#1}}}
\newcommand{\ffzd}[1]{{\mathbb{F}^{d\;*}_{#1}}}
%% \newcommand{\dotprod}{quadratic Hermitian form}}
\newcommand{\dotprod}{dot product}
\newcommand{\todo}[1]{\textbf{TODO.~#1}}

\newcommand{\p}[1]{^{(#1)}}

\def\gbar{\overline{\gamma}}
\def\rev{{\cal R}_{\ca,\rho}}

\def\imod#1{\allowbreak\mkern8mu({\operator@font mod}\,\,#1)}

\newcommand{\half}{\mbox{$\textstyle \frac{1}{2}$} }
\newcommand{\proj}[1]{\ket{#1}\! \bra{#1}}
\newcommand{\outerp}[2]{\ket{#1}\! \bra{#2}}
\newcommand{\inner}[2]{ \langle #1 | #2 \rangle}
\newcommand{\melement}[2]{ \langle #1 | #2 | #1 \rangle}
\newcommand{\bitem}{\begin{itemize}}
\newcommand{\eitem}{\end{itemize}}
\newcommand{\benum}{\begin{enumerate}}
\newcommand{\eenum}{\end{enumerate}}
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\beqa}{\begin{eqnarray}}
\newcommand{\eeqa}{\end{eqnarray}}
\newtheorem{definition}{Definition}
\newtheorem{assertion}{Assertion}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}{Proposition}
\newtheorem{axiom}{Axiom}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem{conjecture}{Conjecture}
\newtheorem{property}{Property}
\newtheorem{fact}{Fact}
\newtheorem{remark}{Remark}
\newcommand{\bproof}{\begin{proof}}
\newcommand{\eproof}{\end{proof}}
\newcommand{\bprop}{\begin{proposition}}
\newcommand{\eprop}{\end{\proposition}}
\newcommand{\bdef}{\begin{definition}}
\newcommand{\zls}{{\mathbb Z}}
%%% This is our own symbol for "discrete probability"
%%    - originally "g", try "\pi" for now.
\newcommand{\dpr}{{\pi}}
\newcommand{\dpt}{{\tilde{\pi}}}
\def\round{\mathop{\rm round}\nolimits}

\newcommand{\amr}[1]{\fbox{\begin{minipage}{0.9\textwidth}\color{red}{Amr says: #1}\end{minipage}}}
\newcommand{\gerardo}[1]{\fbox{\begin{minipage}{0.9\textwidth}\color{OliveGreen}{Gerardo says: #1}\end{minipage}}}
\newcommand{\andy}[1]{\fbox{\begin{minipage}{0.9\textwidth}\color{blue}{Andy says: #1}\end{minipage}}}
\newcommand{\yutsung}[1]{\fbox{\begin{minipage}{0.9\textwidth}\color{purple}{Yu-Tsung says: #1}\end{minipage}}}

\newcommand{\fnorm}[1]{\mathsf{N}(#1)}
\newcommand{\mod}{\mbox{mod }}

\makeatother

\usepackage{babel}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\title{Contextuality and Nonlocality in Discrete Quantum Theory}

\author{John Gardiner$^{1}$, Andrew J. Hanson$^{2}$, Gerardo Ortiz$^{3}$,
Amr Sabry$^{2}$, Yu-Tsung Tai$^{4,2}$}


\address{$^{1}$ Department of Physics and Astronomy, University of California,
Los Angeles, CA 90095, USA}


\address{$^{2}$ School of Informatics and Computing, Indiana University,
Bloomington, IN 47405, USA}


\address{$^{3}$ Department of Physics, Indiana University, Bloomington, IN
47405, USA}


\address{$^{4}$ Department of Mathematics, Indiana University, Bloomington,
IN 47405, USA}


\ead{ortizg@indiana.edu}
\begin{abstract}
\today
\end{abstract}

\pacs{03.65.-w, 03.65.Ud, 03.65.Ta, 02.10.De}


\noindent{\it Keywords\/}: {contextuality, nonlocality, measurement process, Gleason's theorem,
Bell's theorem, the Kochen-Specker theorem}


\submitto{\jpa}

\maketitle

\rm \normalsize

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}

Theories of quantum mechanics based on finite complexified fields can
provide novel insights into subtle issues of nonclassical theories.  While
the study of such discrete quantum theories is motivated by the desire
to restrict our physical theories to computable numbers, all such
theories are handicapped by the absence of naturally ordered
quantities that can be associated with traditional probabilities.

\gerardo{This paper is about the measurement process in Discrete 
  Quantum Theories, that is, the process by which one extracts 
  information from a physical system in a hypothetical world 
  characterized by a finite number of resources, albeit arbitrarily 
  large.}

\amr{I would also start with a statement along the following lines and
  then using Gerardo's paragraph: Whether Nature is continuous or
  discrete, any \emph{representation} of a physical system in a
  computer or in a laboratory must use finite resources. In the realm
  of quantum computing, these finite resources must arguably be
  founded on vector spaces over finite fields that have as many
  properties of the conventional Hilbert spaces. This paper is about
  the measurement process in Discrete Quantum Theories, that is, the
  process by which one extracts information from a physical system in
  a hypothetical world characterized by a finite number of resources,
  albeit arbitrarily large.}

Having investigated the geometrical implications and properties of
discrete quantum theories in previous
work~\cite{geometry2013,DQT2014}, we turn here to the study of the
measurement process within such theories.  Our goal is to rediscover
properties of the foundations of standard axiomatic quantum mechanics,
including Gleason's theorem, the Kochen-Specker theorem, and Bell's
theorem, consistent within the discrete-field context, even while
lacking ordered probabilities in the number system.  We find for
example, that the discrete version of Gleason's theorem motivates a
corresponding Born rule.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fundamentals}

Measurement, considered as the process by which one extracts
information from a physical system in a world with finite resources,
is a fundamental property of quantum mechanics in our discrete field
context that we will study in this paper.

\andy{This section needs a clear treatment of {\it contextuality\/},
  and a mention of the issues for measurement with possibly illegal
  intermediate states, and degenerate eigenvalues as troublesome
  special cases.} 

\gerardo{Add a statement ``Here we concentrate on a discrete quantum
  theory that uses the number systems, but not the cardinal
  probability adaptation, that we introduced in our previous
  paper~\cite{DQT2014}, that used partially transitively-ordered sets
  to address the question of probabilities.''}

In quantum mechanics, measurement is contextual, meaning that the
outcome of an experiment depends not only on the system being measured
and the choice of the measured observable, but also on the details of
the measurement process. It is also nonlocal, meaning that
correlations exist that are inconsistent with causal influences.
Classical physics, on the other hand, seems to be local and
independent of the context.  The introduction of hidden variables,
along with several important results proving their inconsistency, have
been motivated from the very early days of quantum mechanics by the
classical intuition that some (partially unknown) local context might
influence the outcome of experiments and thus invalidate traditional
quantum theory.

\paragraph{The Concept of Contextuality and its Role in the Properties
  of Candidates for Quantum Theories.}
Quantum Physics is contextual, meaning that the outcome of a
measurement (or a set of measurements) depends not only on the choice
of the measured observable(s) and on the system being measured, but
also on the details of the measurement process.  To be more precise,
as noted by Peres~\cite{peres1995quantum} and
Mermin~\cite{MerminPRL1990}, the result of measuring an observable in
a physical system must not depend on whether we measure the observable
alone, or along with arbitrary sets of mutually commuting observables.

Classical Physics, on the other hand, is usually agreed to be
independent of the context; that is, we presume that every physical
variable has a predetermined value.  The motivation for studying the
possibility that the probabilistic features of quantum mechanics can
be explained by hidden variables is the possibility that a (partially
unknown but complete) context influences the outcome of experiments.

\paragraph{Basic Features We Expect in Quantum Theories.}
To understand how much of conventional measurement theory we can
maintain in discrete quantum theories without ordered probabilities,
along with the possibility of non-trivial null-norm states, we must
critically address three pillars at the foundation of traditional
quantum theories. Many of these issues are treated in detail, e.g., in
Peres~\cite{peres1995quantum}.  The issues we shall consider are:

\begin{itemize} 

\item {\it Gleason's theorem\/} tells us that for Hilbert spaces of
  dimension $>2$, the Born Rule is the \emph{only} way to assign
  consistent probabilities to the statistical prediction of a quantum
  measurement~\cite{gleason1957}.  This result excludes a very general
  class of hidden variable theories using continuity and
  probabilities.  In the conventional quantum formalism the Born rule
  provides the link between the formalism of quantum mechanics and the
  potential results of experimental observations.  In order to achieve
  similar results with finite fields, we must find a way around the
  dependence on continuity and ordered probabilities.  Replacing
  continuous-valued probabilities with discrete interval-valued
  probabilities (e.g., possible and impossible measurement outcomes)
  provides one route to the desired outcomes.

\item {\it The Kochen-Specker theorem\/} in its classical form employs
  a complicated array of measurements on a single system along with
  geometric arguments to exclude additional wide classes of hidden
  variable theories~\cite{kochenspecker1967}.  The Kochen-Specker
  theorem does not depend on statistical averages, and it is geometric
  in spirit.  (More succinct approaches can be found, e.g., in
  Peres~\cite{peres1995quantum}.)  The freedom from statistical
  averages in the Kochen-Specker methods suggests that important parts
  of the result could be independent of ordered probabilities and thus
  in fact might possess suitable analogs in finite fields.  The key is
  to understand the implications of contextuality, and here we find
  that the possibility of valid null intermediate states in discrete
  quantum theory can disrupt what would seem to be trivial
  contextuality.  To deal with this, we are compelled to explicitly
  consider, not only the initial and final resources needed to
  represent the system and the final measurement outcome, but also the
  resources needed to represent the intermediate steps in a series of
  experiments. We find that, to preserve the spirit of the
  Kochen-Specker theorem, we have to explicitly introduce and propagate
  \emph{error states} whose representation requires more than the
  available resources.

\item {\it Bell's theorem\/} reveals the intrinsic non-local nature of
  correlations in quantum physics, i.e., the nature of entanglement,
  which has no classical analog~\cite{BellBook1987}.  Bell's original
  arguments depended on continuity and probability to produce
  inequalities satisfied by any local realistic theories, as broadly
  defined by Einstein, thus quantifying nonlocality.  Since then, many
  Bell-type inequalities have been derived for different observable
  quantities, refined by the incorporation of particular experimental
  setups.  In addition, it was later
  realized~\cite{GHZ1990,CabelloPRL.86.2001} that one can derive
  Bell-type equalities encoding non-local correlations and, as we will
  see, it is this version of Bell's theorem that is generalizable to
  Discrete Quantum Theories.

\end{itemize}

All of these basic insights into the structure of traditional quantum
mechanics rely on {\it contextuality\/} and {\it nonlocality\/}: We
will argue in our conclusions that, in discrete quantum theory, we can
consistently employ both contextuality, the statement that measurement
of a quantum observable does not depend on any given second observable
provided it commutes with the first observable, and, nonlocality,
which says that spatially separated measurements in a quantum theory
can in fact be correlated, counter to classical intuitions.

\andy{
\section*{Internal note: Structure Outline}
\begin{itemize} 
\item {\bf Critical analysis of measurement in conventional theory.} 
\item {\bf Discrete Vector Space.}  $\ffd{p^2} \to \ffzd{p^2}$.
\item {\bf No go theorem.} Cannot use Real numbers in $[0,1]$.
\item {\bf Post measurement issues.} Requires explicit error states.
\item {\bf Show contextuality works.} Prove Gleason, Bell, and
  Kochen-Specker to conclude that DQT with interval-valued
  probabilities and explicit error states is sufficient to retain a
  quantum theory with contextuality and absence of local hidden
  variables.
\end{itemize}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Critical Analysis of the Measurement Process in CQT}

Before discussing the measurement process and the manifestations of
nonlocality and contextuality in discrete quantum mechanics, we first
review various notations brought forward from conventional quantum
theory.  Assume that a physical system is represented by a state
$\ket{\Psi}$, and that we wish to measure a physical quantity
${\cal O}$ of this system, with corresponding observable
${\mathbf O}$, whose eigenspectrum is given by
\[ {\mathbf O} \left|i\right\rangle = \lambda_{i} \left|i\right\rangle
\ . \]
Then Born's rule of CQT tells us that the probability of obtaining the
eigenvalue $\lambda_{i}$ as an outcome of the measurement is given by
\begin{eqnarray}
\begin{array}{rcccl}
{\cal P}_{\Psi}\left(\lambda_{i}\right) & = &
\displaystyle{\frac{\langle\Psi |{P}_{i} |  \Psi\rangle}
{\ip{\Psi}{\Psi}}}
& = &
\displaystyle{
\frac{\ip{\Psi}{i}\ip{i}{\Psi}}{\ip{\Psi}{\Psi}\ip{i}{i}} }
\end{array}
\ ,
 \label{prob1.eq}   
\end{eqnarray}
where ${P}_{i}$ is the projector onto the subspace generated by the
eigenvector $\left|i\right\rangle$.  We have until now assumed
non-degenerate eigenvalues.  If, for some set of states $\{k\}$, the
eigenvalue $\lambda$ is degenerate, we account for that by replacing
the simple expression for the projector $P_{i}$ by
\[ P_{\lambda} = \sum_{k=1}^{K_{\lambda}}
\frac{ \left|k\right\rangle  \left\langle k\right|}
{ \ip{k}{k}} \ ,
\]
where $K_{\lambda}$ is the degeneracy of the eigenvalue $\lambda$.

% We will assume in the following that this is taken into
% account, except for particular cases where degeneracy is explicitly
% involved in distinguishing the behavior of DQT from CQT.

One other issue that will confront us in the transition from CQT to
DQT is the presence of post-measurement states.  In CQT, the Von
Neumann projective measurement state, immediately after the
measurement of ${\cal O}$, is given in general by
\[
  \frac{P_{\lambda} \ket{\Psi}}
       {\sqrt{\langle\Psi |{P}_{\lambda} | \Psi\rangle}} \ ,
\]
where for the non-degenerate case, $P_{\lambda} \to {P}_{i}$, and so
the resulting state is just $\ket{i}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%  Here we look at the theorem that says a MIXED MODE
%%%  probability theory, with discrete vectors but
%%%  real-valued probabilities, is not consistent.
\section{States, Observables, and Probability in DQT}

Following the development in the previous section, we need to
carefully define a few notions in order to describe the measurement
process in DQT. In the following, we will briefly introduce discrete
quantum theory (DQT), as defined in~\cite{geometry2013,DQT2014}, and
will highlight the main differences and contrasts with conventional
quantum theory (CQT). We will start by definining states and
observables and then spend the remainder of the section investigating
the proper notion of probability in DQT.

%%%%%%%%%%%%%%%%%
\subsection{States in DQT}
 
Our fundamental divergence from CQT is to replace continuous complex
amplitudes in the field of complex numbers $\C$ by discrete fields
$\ff{p^{2}}$.  If we restrict ourselves to odd primes with
$p\equiv 3\mod 4$, the fields $\ff{p}$ are exactly those for which
$x^2+1$ has no root in the field, and we can adjoin $\rmi$ as a
root of $x^2+1$ to the field $\ff{p}$.  For a given element
$\alpha \in \ff{p^2}$, we define the equivalent of complex conjugation
as the map $\alpha\mapsto\alpha^p$, which we may write as
$\alpha^*=\alpha^p$. The resulting extended field is isomorphic to
$\ff{p^2}$ and is a realization of discrete complex numbers suitable
for quantum mechanical calculations.

Let us start by defining a vector space $\ffd{p^{2}}$ of
$d$-dimensional vectors with elements in $\ff{p^{2}}$, where the
conjugate transpose is defined in the natural way giving us the notion
of a dual vector $\bra{\Psi}$ for every vector
$\ket{\Psi}\in\ffd{p^2}$ as well as unitary operators.  Next we
propose the Hermitian dot product defined as the map from
$\ffd{p^2}\times\ffd{p^2}$ to $\ff{p^2}$ given by
$(\ket{\Psi},\ket{\Phi})\longmapsto \braket{\Phi}{\Psi}$.  Notice that
this product is technically not an inner product because there are
vectors $\ket{\Psi}$ other than the zero vector whose ``norm''
$\braket{\Psi}{\Psi}$ vanishes.  We therefore exclude such cases by
moving to the domain $\ffzd{p^{2}}$, where the ${}^{*}$ indicates the
exclusion of null vectors; that is we consider
$\ket{\Psi}\in\ffzd{p^{2}}$, where
\[\ffzd{p^{2}}=\left\{
  \ket{\Psi}\in\ffd{p^{2}}\mid\ip{\Psi}{\Psi}\ne 0\right\} \ . \] 

\amr{we want to emphasize that it is not sufficient to remove these
  null vectors once and for all at the beginning of time; it is
  possible to wrap around during calculation (unitary evolution as
  well as projection to post-measurement state) and produce a null
  state from a well-defined state. In the rest of the paper (say where
  exactly) we will arrange for such invalid operations to be detected
  and dealt with properly.}

\gerardo{1) When the eigenvalues are non-degenerate there is never a
  problem; 2) The problem is a manifestation of the lack of
  resources. Had we used a larger p from the start, this situation
  would have been avoided.}

\andy{I definitely agree. Gerardo and I discussed at length whether
  the decision to "fix the p in advance" could be relaxed, and, though
  that is very complicated, I think that we make a very good
  connection to the previous paper if we emphasize the role of the
  size of p and the RESOURCES.  Without changing p in the measurement
  PROCESS, it is still legitimate to state that a glitch in the
  PROCESS can arguably come directly from the RESOURCES allocated.
  Then our overall story is that DQT permits the splitting-apart of
  "computability" in quantum theories into state-representation and
  measurement resources.  So I'd say, if anything, such an
  interpretation needs to be expanded and made very clear.  Then the
  readers of the sequence of papers know exactly who we are and what
  our narrative implies about computability and quantum theory in
  general.}

\amr{Long discussion about whether to allow zero norm states as
  intermediate values. Also discussion about whether we are computing
  with states or equivalence classes of states; in the latter case,
  all zero-norm states should be equivalent.}

%%%%%%%%%%%%%%%%%
\subsection{Unitary and Hermitian operators in DQT}

After we define the state vectors and the Hermitian dot product, we
are ready to define unitary and Hermitian operators representing time
evolutions and observables, respectively. All unitary operators can
represent time-evolution operators. Because a unitary operator~$\mathbf{U}$
preserves norm, a physical state~$\ket{\Psi}$ always evolves to
another physical state~$\mathbf{U}\ket{\Psi}$ according to $\mathbf{U}$.\footnote{Although some unitary operators might not be induced by a Hamiltonian,
we might discuss further in our upcoming papers.} 

The situation for observables is more delicate. As discussed in section
3, the measurement result of an observable~$\mathbf{O}$ is a real
number and a eigenvalue of $\mathbf{O}$; the post-measurment state
is a physical state as well as an eigenvector of $\mathbf{O}$. However,
a Hermitian operator~$\mathbf{H}$ over $\ff{p^{2}}$ may not be
qualified for an observable because $\mathbf{H}$ may not have suitable
eigenvalues and eigenvectors to define the measurement precess, or
equavalently $\mathbf{H}$ is not unitarily diagonalizable, for the
following reasons:
\begin{enumerate}
\item \label{enu:eigenvalueCount}$\mathbf{H}$ may lack of eigenvalues.
\\
\yutsung{No eigenvalue is a problem, but how to clearly say why no
enough eigenvalue is a problem?}\\
Formally, the total multiplicity of eigenvalues of $\mathbf{H}$ in
$\ff{p^{2}}$ may be less than $d$, where the multiplicity of an
eigenvalue $\lambda$ is $K_{\lambda}$ means that $\left(x-\lambda\right)^{K_{\lambda}}$
is a factor of the characteristic polynomial 
\begin{equation}
\det\left(\mathbf{A}-x\mathds{1}\right)\textrm{ ,}\label{eq:characteristic}
\end{equation}
while $\left(x-\lambda\right)^{K_{\lambda}+1}$ is not a factor of
the characteristic polynomial. This happens because $\ff{p^{2}}$
is not algebraically closed~\cite{DummitFoote2004} so that the solutions
of the characteristic polynomial may be in an proper extension field
of $\ff{p^{2}}$. For example, consider a Hermitian matrix 
\[
\mathbf{H}_{1}=\left(\begin{array}{ccc}
-1 & -\rmi & 0\\
\rmi & 1 & -\rmi\\
0 & \rmi & 1
\end{array}\right)
\]
whose characteristic polynomials over $\ff{9}$ are
\begin{eqnarray*}
\det\left(\mathbf{H}_{1}-x\mathds{1}\right) & = & 2x^{3}+x^{2}+2
\end{eqnarray*}
which have no solution in $\ff{9}$ so that their total multiplicities
are 0 less than 3. In this case, $\mathbf{H}_{1}$ should not be an
observable because there is no eigenvalue as any measurement result. 
\item \label{enu:degeneracy}\yutsung{The same. How to say clearly why
no enough eigenvector is a problem?}\\
 The dimension of an eigenspace may be less than the multiplicity
of its eigenvalue. For example, consider a Hermitian matrix 
\[
\mathbf{H}_{2}=\left(\begin{array}{cc}
-1 & -1-\rmi\\
-1+\rmi & 0
\end{array}\right)
\]
Over $\ff{9}$, its only eigenvalue is $1$ of multiplicity $2$.
The only eigenspace of $\mathbf{H}_{2}$ is spanned by $\left(\begin{array}{cc}
1 & -1+\rmi\end{array}\right)^{T}$. The dimension of eigenspace is 1 less than 2 so that $\mathbf{H}_{2}$
are not diagonalizable over $\ff{9}$. If $\mathbf{H}_{2}$ were an
observable, $\mathbf{H}_{2}$ would always have the outcome of measurement
$1$ with the post-measurement state $\left(\begin{array}{cc}
1 & -1+\rmi\end{array}\right)^{T}$. However, only operator always producing $1$ is the identity operator
which change no state. Therefore, $\mathbf{H}_{2}$ may not be intuitively
as an observable.\\
 In order to understand this non-diagonalability, we can diagonalize
them in $\C$. The eigenvalues of $\mathbf{H}_{2}$ in $\C$ are $1$
and $-2$. 
\begin{eqnarray*}
-2 & \equiv & 1\left(\bmod p\right)
\end{eqnarray*}
In another word, two eigenvalues in $\C$ map to only one eigenvalue
of multiplicity $2$ in $\ff{9}$, and the corresponding two eigenspaces
with dimension $1$ in $\C$ map to one eigenspace still with dimension
$1$ in $\ff{9}$. 
\item \label{enu:orthonormal}Some eigenvectors are zero-norm so that $\mathbf{H}$
may be diagonalizable, but not unitarily diagonalizable. In this case,
the corresponding eigenvalue~$\lambda$ of a Hermitian matrix may
not be in $\ff{p}$.\\
 For example, consider a Hermitian matrix~$\mathbf{H}_{3}$ 
\[
\mathbf{H}_{3}=\left(\begin{array}{cc}
-1 & -1-\rmi\\
-1+\rmi & -1
\end{array}\right)
\]
Over $\ff{9}$, the eigenvalues and eigenvectors of $\mathbf{H}_{3}$
are $-1-\rmi$ with $\left(\begin{array}{cc}
1 & -1-\rmi\end{array}\right)^{T}$ and $-1+\rmi$ with $\left(\begin{array}{cc}
1 & 1+\rmi\end{array}\right)^{T}$. It is easy to verify the eigenvalues are not in $\ff{3}$, and the
eigenvectors are all zero-normed.\\
 If we diagonalize $\mathbf{H}_{3}$ in $\C$, we have the eigenvalues
of $\mathbf{H}_{3}$ in $\C$ are $-1\pm\sqrt{2}$. If we extend the
modulo $p$ to algebraic number by 
\[
a\equiv b\left(\bmod p\right)\Leftrightarrow\pm\sqrt{a}\equiv\pm\sqrt{b}\left(\bmod p\right)
\]
then 
\begin{eqnarray*}
-1\pm\sqrt{2} & \equiv & -1\pm\rmi\left(\bmod p\right)
\end{eqnarray*}
In another word, although the extended modulo $p$ operation respects
any field operations and roots, it does not respect the complex conjugate
so that any definition depend on the complex conjugate may not be
preserved when we map them into finite fields. \yutsung{Although
may not need to type it down, need to check the definition of the
map, passing congruence into square root, and partial homomorphism...
etc.}
\end{enumerate}
As long as there exists a non-zero-norm eigenbasis of $\mathbf{H}$,
$\mathbf{H}$ has an orthonormal eigenbasis~\cite{grove2002classical}.
Therefore, these are the only reasons that $\mathbf{H}$ may not be
unitarily diagonalizable, or an observable. Besides, some unitary
operators are not unitarily diagonalizable as well although they are
still time-evolution operators.

\yutsung{
I don't know whether there is a relation between the occurrence of
zero norm post-measurement states and anomalies in the list of possible
observables, especially we have already required any observables must
be unitarily diagonalizable.

I am sure I have asked Prof. Lunts ``what we can say for the eigenvalues
of Hermitian matrices over finite fields,'' and he seems not sure.
I guess I also asked Prof. Thurston the same question, but I am not
sure...
}

\andy{We want to see where the argument of {\em compatible observables}
  fits in.}

%%%%%%%%%%%%%%%%%
\subsection{Considering Continuous Probabilities} 

As seen in the previous section, the CQT Born rule gives a physical
meaning to the state vectors, which can be seen as holding the
information regarding outcomes of measurements.  Given a state
$\ket{\Psi}$, the measurement of a physical quantity will result in
one of some number of mutually exclusive outcomes $\lambda$.

It is worth asking whether the state vectors in DQT can contain
probabilistic information about measurement outcomes.  When the Born
rule is literally translated directly into the finite field framework,
i.e., so the quantity ${\cal P}_{\Psi}(\lambda)$ is in the field
$\ff{p}$, then ${\cal P}$ can no longer be considered as a probability
because it cannot be interpreted as a real number in the interval
$[0,1]$, or as any other transitively ordered set.  Thus in order to
get a rule in DQT for extracting information from the state vectors,
the Born rule must be modified.

Thus we are led first to consider the most obvious extension, which is
to postulate the existence of a consistent function $\dpt$ with
outcomes compatible with CQT, that is
\[\dpt\colon \ffzd{p^2}\times \ffzd{p^2}
\longrightarrow [0,1]\ . \]

For the outcomes of this new rule to truly be interpreted as
probabilities, the rule $\dpt$ must satisfy certain properties.
First, probabilities must satisfy a normalization requirement:
\begin{description}
\item[(i)]  For any orthonormal basis $\{\ket{i}\}$ and any state
  $\ket{\Psi}$, $\displaystyle \sum_{i=0}^{d-1} \dpt(\ket{\Psi},\ket{i})=1$.
\end{description}
That is, the sum of probabilities for a complete set of mutually
exclusive outcomes must be 1.  To motivate the next requirement,
consider the state $\alpha\ket{0}+\beta\ket{1}$ in the vector space
spanned by $\ket{0}$ and $\ket{1}$.  We can embed this vector subspace
in the larger $d$-dimensional space spanned by $\ket{0}$, $\ket{1}$,
\ldots, $\ket{d-1}$ and view our state in the larger vector space,
i.e., view $\alpha\ket{0}+\beta\ket{1}$ as
$\alpha\ket{0}+\beta\ket{1} + 0\ket{2} + \cdots+ 0\ket{d-1}$.  The
probabilities corresponding to outcomes $\ket{0}$ and $\ket{1}$ should
not depend on whether we are viewing the state in the original
two-dimensional subspace or the larger one. Thus, in light of property
({\bf i}), the probabilities corresponding to outcomes $\ket{2}$,
\ldots, $\ket{d-1}$ should all be zero. This suggests the following
necessary condition:
\begin{description}
\item[(ii)]
If $\braket{\Phi}{\Psi}=0$ then $\dpt(\ket{\Psi},\ket{\Phi})=0$.
\end{description}
The final property we require of a rule for deriving probabilities is
that it be basis independent:
\begin{description}
\item[(iii)]
$\dpt(U\ket{\Phi},U\ket{\Psi})=\dpt(\ket{\Phi},\ket{\Psi})$ 
where $U$ is any unitary map.
\end{description}

In CQT, Gleason's theorem~\cite{gleason1957} shows that properties
similar to these are sufficient to uniquely identify the Born rule as
the only consistent rule for defining probabilities from states when
$d>2$.  If we adopt the natural conditions ({\bf i}), ({\bf ii}), and
({\bf iii}) in DQT, we find from the following theorem that a map
$\dpt$ satisfying these conditions does not exist.

%%%%%%%%%%%%%%%%%
\subsection{A No-Go Theorem}

We will fill out our arguments by introducing a no-go theorem that
explains why it is impossible in DQT to incorporate into Born's rule a
continuous real probability in the interval $[0,1]$.

\begin{theorem}
\label{theorem1}
There is no map $\dpt\colon \ffzd{p^2}\times \ffzd{p^2}
\longrightarrow [0,1]$ satisfying properties ({\bf i}), ({\bf ii}),
and ({\bf iii}) when $d> 3$.
\end{theorem}
%
\begin{proof}
  Assume such a map $\dpt$ satisfying all three properties exists.
  Consider the state
\[
\ket{\Psi}=\alpha\big(\ket{0} + \ket{1} + \ket{2} + \beta\ket{3}\big)
\]
expressed in terms of orthonormal vectors, where $\beta\in \ff{p^2}$
is chosen so that $\left|\beta\right|^2=p-1$ and $\alpha\in\ff{p^2}$
is a constant such that $\ket{\Psi}$ is normalized.  Let
$\ket{\Phi}= \ket{1} + \ket{2} + \beta\ket{3}$. Note that $\ket{\Phi}$
is normalized in $\ff{p}$.  We can write our original state
$\ket{\Psi}$ as $\ket{\Psi}=\alpha\big(\ket{0}+\ket{\Phi}\big)$ The
vectors $\ket{0}$ and $\ket{\Phi}$ are orthonormal and so are part of
some larger orthonormal basis. Thus by properties ({\bf i}) and ({\bf
  ii}) we have
\begin{equation}
1= \dpt\big(\ket{\Psi},\ket{0}\big) +  \dpt\big(\ket{\Psi},\ket{\Phi}\big). \label{prob1}
\end{equation}
Let $U$ be the unitary map that simply permutes the orthonormal
vectors $\ket{0}$ and $\ket{\Phi}$.  Note that $\ket{\Psi}$ is
invariant under $U$, so invoking property ({\bf iii}), we have
\[
\dpt\big(\ket{\Psi},\ket{0}\big)=\dpt\big(U\ket{\Psi},U\ket{0}\big) = 
   \dpt\big(\ket{\Psi},\ket{\Phi}\big) \ .
\]
This along with equation (\ref{prob1}) gives
\[
1= \dpt\big(\ket{\Psi},\ket{0}\big) +  \dpt\big(\ket{\Psi},\ket{0}\big),
\]
so
\begin{equation}
\label{prob2}
\dpt\big(\ket{\Psi},\ket{0}\big)=\dpt\big(\ket{\Psi},
   \ket{\Phi}\big)=\frac{1}{2} \in [0,1] \ .
\end{equation}

For $i=0,1,2$ let $U_i$ be the unitary map that permutes the basis
vectors $\ket{0}$ and $\ket{i}$ and acts as the identity for the rest.
Note that $\ket{\Psi}$ is invariant under $U_i$. So again by property
({\bf iii}) we have
\[
\dpt\big(\ket{\Psi},\ket{i}\big) =\dpt\big(U_i\ket{\Psi},U_i\ket{0}\big)=
\dpt\big(\ket{\Psi},\ket{0}\big) = \frac{1}{2}
\]
for $i=0,1,2$.  These probability assignments are inconsistent with
the requirement that the probabilities for orthogonal outcomes add up
to 1. By property ({\bf i})
\begin{eqnarray*}
1 & = & \dpt\big(\ket{\Psi},\ket{0}\big)+\dpt\big(\ket{\Psi},\ket{1}\big)+\dpt\big(\ket{\Psi},\ket{2}\big)+\dpt\big(\ket{\Psi},\ket{3}\big)\\
 & = & \frac{1}{2}+\frac{1}{2}+\frac{1}{2}+\dpt\big(\ket{\Psi},\ket{3}\big)\\
 & \geq & \frac{3}{2},
\end{eqnarray*}
so we have a contradiction. The assumption of a satisfactory map
$\dpt$ is thus false. $\Box$
\end{proof}
(It should be pointed out that the argument above explicitly uses
states from a vector space of four dimensions or larger, and thus does
not hold if the largest vector space one can consider has dimension
$d\le 3$.  But it does hold for any system that, for example, contains
more than a single qubit.)

What are the implications of this theorem?  Intuitively one might
think that the lack of an order on the field elements is the main
obstacle to extracting probabilities from DQT, but the above result
shows that this is not the case.  Even supplementing the field
elements with an ordering does not allow for a rule that satisfies the
three properties above.  And any other scheme for extracting
probabilities from quantum mechanics over a finite field will violate
one of the three properties above.

We next observe that one way out of this dilemma is to define a
framework for quantum measurement in DQT that is based not upon
probabilities but upon discrete interval-valued probabilities.

\gerardo{There is a paper by Mermin, Quantum Mysteries
  Revisited~\cite{MerminPRL1990}, that could be used profitably in the
  next arguments.  See also John's paper, section ``GHZ
  Experiment.''}

%%%%%%%%%%%%%%%%%
\subsection{Interval-Valued Probabilities for DQT}

\yutsung{
It seems that almost everything currently in this section should move to Section 5, because they are already focus on the measurement process in DQT, especially $\dpr \left(\ket{\Psi},\ket{\Phi}\right)$ should be intuitively corresponding to ${\cal P}_{\Psi}\left(\lambda_{i}\right)$ in CQT. Or we may combine Section 4.5 and Section 5.1 into one section.

If we want to keep Section 4.5 and Section 5.1 separately, we may try to focus on the definition of Interval-Valued Probabilities and these algebraic relation, like =, 0, 1, and +. However, the readers may not know why they need these algebraic relation before we define the measurement process...
}

In order to write down the analog of the CQT Born rule and
quantum measurement process for DQT, we must explicitly define a
corresponding discrete measurement framework.  To this end, consider
an orthogonal basis $\{\left|i\right\rangle\}$ of $\ffzd{p^2}$.  In
this basis, two arbitrary vectors can be written in the form
\begin{equation}
\ket{\Psi}=\sum_{i=0}^{d-1}~\alpha_{i}\left|i\right\rangle \ ,\
\ket{\Phi}=\sum_{i=0}^{d-1}~\beta_{i}\left|i\right\rangle , 
\end{equation}
with $\alpha_{i}$ and $\beta_{i}$ elements of the field $\ff{p^{2}}$.
The Hermitian product in our discrete number system is thus 
reducible to the form
 \begin{equation}
   \ip{\Phi}{\Psi}=\sum_{i=0}^{d-1}~{\beta_{i}}^{p}~\alpha_{i}^{\;}
     \ .
\label{innerprod}  
\end{equation}

%% Needed?? ~\cite{DQT2014}.. ~\cite{grove2002classical}

These issues are all crucial for DQT because in the discrete domain we
do not have transitive ordered probabilities defined on the real
numbers.  Furthermore, although the physical state $\ket{\Psi}$ before
the measurement belongs to $\ffzd{p^2}$, the post-measurement state
may not belong to $\ffzd{p^2}$ in the case of {\it degenerate
  eigenvalues\/}.

This leads us to introduce a modified Born's rule, with
values in discrete interval-valued probabilities, for the study of the
properties that DQT shares with CQT but not with classical theories.
It will turn out that in order to accommodate the anomalous situation
where post-measurement states do not belong to $\ffzd{p^2}$, we
explicitly detect such invalid intermediate states and cause them to
halt the entire computation immediately.

\amr{I think the previous two paragraphs could be even more clear if
  we said the following. First we talk about the no-go theorem and say
  that we must go to ``interval-valued probabilities.'' Then say we
  will use two intervals {\it (possible, impossible) \/}. Then explain
  that a measurement operation is a \emph {partial function } that
  takes a current state (non-null vector) and an observable ${\cal O}$
  and as explained next produces \emph{three} things when defined.
  Generally if we measure observable ${\cal O}$ of quantum state
  $\ket{\phi}$, then (i) with interval-value probability $p_i$, (ii)
  the result of the measurement will be eigenvalue $\lambda_i$, and
  (iii) the quantum state will collapse to the state
  $\ket{\psi}_i$. In the case the post-measurement state would be null
  because of wrapping around that might occur with degenerate
  observables the entire measurement operation is
  \emph{undefined}. Otherwise the result is the triple of probability,
  eigenvalue, and post-measurement state.  Note that composition of
  measurement operations is only defined if both measurement
  operations are defined. In particular, if is possible that two
  commuting observables ${\cal O}_1$ and ${\cal O}_2$ could be
  measured in one order but not the order if one of the intermediate
  steps is undefined.}

 Since discrete quantum theories do not have orderable fields, and thus
lack orderable probabilities, we must discover a way to understand how
Born's rule could manifest itself in a consistent discrete theory.

To begin our study of discrete theory, we define a map $\dpr $ that
will play the role of a discrete Born rule, with the replacement of
real-valued probabilities by the two tags 'impossible' and 'possible':
\[\dpr :\ffzd{p^{2}}\times\ffzd{p^{2}}\rightarrow\mathscr{L}_{2} = \left\{
\text{impossible},\text{possible}\right\} , \]
Thus $\dpr $ can be defined in the possibility field $\mathscr{L}_{2}$ 
as
\begin{equation}
\dpr \left(\ket{\Psi},\ket{\Phi}\right)=
\left\{ \begin{array}{r@{\textrm{, if }}l}
\textrm{possible} & \ip{\Psi}{\Phi}\ne 0\\
\textrm{impossible} & \ip{\Psi}{\Phi}=0
\end{array} \right. \ .
\label{eq:modality}
\end{equation}

% \begin{equation}
% \dpr \left(\ket{\Psi},\ket{\Phi}\right)=\begin{cases}
% \text{possible} & \textrm{, if }\ip{\Psi}{\Phi}\ne 0\\
% \text{impossible} & \textrm{, if }\ip{\Psi}{\Phi}=0
% \end{cases} \ .
% %\label{eq:modality}
% \end{equation}

% {\bf Remark}: The natural occurrence of null-norm intermediate states
% in examples of two-operator measurement systems used to test
% contextuality will lead us to the requirement for a three-valued
% logic, $\mathscr{L}_{3}$, with a possibility of the value
% $\text{inconsistent}$.  For clarity of exposition, we employ the
% two-valued modal logic $\mathscr{L}_{2}$ until absolutely necessary.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Measurement Process in DQT}

%%%%%%%%%%%%%%%%%
\subsection{Basic Measurement} 

\amr{Adapt the following to DQT}

Assume that a physical system is represented by a state $\ket{\Psi}$,
and that we wish to measure a physical quantity ${\cal O}$ of this
system, with corresponding observable ${\mathbf O}$, whose
eigenspectrum is given by
\[ {\mathbf O} \left|i\right\rangle = \lambda_{i} \left|i\right\rangle
\ . \]
Then Born's rule of CQT tells us that the probability of obtaining the
eigenvalue $\lambda_{i}$ as an outcome of the measurement is given by
\begin{eqnarray}
\begin{array}{rcccl}
{\cal P}_{\Psi}\left(\lambda_{i}\right) & = &
\displaystyle{\frac{\langle\Psi |{P}_{i} |  \Psi\rangle}
{\ip{\Psi}{\Psi}}}
& = &
\displaystyle{
\frac{\ip{\Psi}{i}\ip{i}{\Psi}}{\ip{\Psi}{\Psi}\ip{i}{i}} }
\end{array}
\ ,
 \label{prob1.eq}   
\end{eqnarray}
where ${P}_{i}$ is the projector onto the subspace generated by the
eigenvector $\left|i\right\rangle$.  We have until now assumed
non-degenerate eigenvalues.  If, for some set of states $\{k\}$, the
eigenvalue $\lambda$ is degenerate, we account for that by replacing
the simple expression for the projector $P_{i}$ by
\[ P_{\lambda} = \sum_{k=1}^{K_{\lambda}}
\frac{ \left|k\right\rangle  \left\langle k\right|}
{ \ip{k}{k}} \ ,
\]
where $K_{\lambda}$ is the degeneracy of the eigenvalue $\lambda$.

%%%%%%%%%%%%%%%%%
\subsection{Degeneracy and Post-Measurement States}

\amr{Explain that problem and need to deal with errors}

% We will assume in the following that this is taken into
% account, except for particular cases where degeneracy is explicitly
% involved in distinguishing the behavior of DQT from CQT.

One other issue that will confront us in the transition from CQT to
DQT is the presence of post-measurement states.  In CQT, the Von
Neumann projective measurement state, immediately after the
measurement of ${\cal O}$, is given in general by
\[
  \frac{P_{\lambda} \ket{\Psi}}
       {\sqrt{\langle\Psi |{P}_{\lambda} | \Psi\rangle}} \ ,
\]
where for the non-degenerate case, $P_{\lambda} \to {P}_{i}$, and so
the resulting state is just $\ket{i}$.

\amr{
Assume O1 and O2 are compatible:
f([O1.O2],psi) = f([O2.O1],psi)

In CQT,
f(O1,f(O2,psi)) = f([O1.O2],psi) = f([O2.O1],psi) = f(O2,f(O1,psi))

In DQT, it is possible that:
f(O1,f(O2,psi)) /= f(O2,f(O1,psi))
because one of them, say f(O1,psi) wraps in the field
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Now we need to look at the DQT measurement process
%%%  and whether we can get around the limitations.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%Gleason's Theorem and the Born Rule, etc.
\section{Contextuality and Non-Locality in DQT}

%%%%%%%%%%%%%%%%%
\subsection{Gleason's Theorem in DQT} The Born rule is the \emph{only}
way to assign a probability in conventional quantum theory because of
Gleason's theorem.  We now show that $\dpr $ defined in
Eq. (\ref{eq:modality}) is an example of a properly defined Born rule
in the discrete theory because $\dpr $ also satisfies the closest
analog of Gleason's Theorem that we can construct.

Following the standard axioms for Gleason's
theorem~\cite{peres1995quantum}, we introduce discrete axioms that
differ in only one significant instance from the classical ones:
\begin{eqnarray}
 & \bullet & \textrm{For any orthogonal basis }\left\{
  \left| n \right\rangle \right\}
  _{n=0}^{d-1}\subset\ffzd{p^{2}}\textrm{, and
  }\label{enu:total-probability-DQT(I)}\\ & &
  \ket{\Psi}\in\ffzd{p^{2}}\textrm{, at least one of\ }
  \dpr \left(\ket{\Psi},\ket{n}\right) = \text{possible.}\nonumber \\ &
  \bullet & \textrm{For any orthogonal basis }
\left\{  \left| n \right\rangle
\right\}_{n=0}^{d-1}\subset\ffzd{p^{2}}\nonumber \\ & &
 \textrm{and a particular\ }\ket{n'}\in\left\{ \left| n \right\rangle \right\}
  _{n=0}^{d-1}\textrm{, }\nonumber \\ & &
  \dpr\big(\ket{n'},\ket{n'}\big)=\text{possible and\ }
   \label{enu:particular-vector-DQT(I)}\\ & &
  \dpr\big(\ket{n'},\ket{n}\big)=\text{impossible for any }n\ne  n'
   \textrm{. }\nonumber \\ & \bullet & \textrm{For any vector  }
   \ket{\Psi},\ket{\Phi}\in\ffzd{p^{2}}
  \textrm{, and  }\gamma\in\ff{p^{2}}\backslash\left\{ 0\right\} 
  \textrm{, }\nonumber
  \\ & &
  \dpr (\ket{\Psi},\ket{\Phi})=\dpr (\gamma\ket{\Psi},\ket{\Phi}) = 
    \dpr (\ket{\Psi},\gamma\ket{\Phi}) \textrm{. }
  \label{enu:parallel-DQT(I)}\\
 & \bullet & \textrm{For any vector
  }\ket{\Psi},\ket{\Phi}\in\ffzd{p^{2}}
  \textrm{, }\nonumber \\ & &
  \textrm{and }U\textrm{ is a }d\textrm{-by-}d
  \textrm{ unitary matrix over }\ff{p^{2}}\textrm{, }
  \label{enu:unitary-DQT(I)}\\ & &
  \textrm{i.e. , }U^{\dagger}U=I\textrm{, then  }
   \dpr (\ket{\Psi},\ket{\Phi})=\dpr (U\ket{\Psi},U\ket{\Phi})\textrm{. }\nonumber
\end{eqnarray}
Because there is no possibility for continuity in the discrete theory,
we have substituted the condition (\ref{enu:unitary-DQT(I)}) for the
conventional continuity axiom in Gleason's Theorem.

%%%%%%%%%%%%%%%%%
\subsection {The Kochen-Specker Theorem in DQT}
The essence of the Kochen-Specker theorem is to ask if it is possible,
for a fixed $\ket{\Psi}\in\ffzd{p^{2}}$, to have another function
$v\left(\ket{\Phi}\right)$ playing the role of
$\dpr \left(\ket{\Psi},\ket{\Phi}\right)$ but failing to satisfy any
single one of the conditions in the set
(\ref{enu:total-probability-DQT(I)},\ref{enu:particular-vector-DQT(I)},
\ref{enu:parallel-DQT(I)},\ref{enu:unitary-DQT(I)}) and to show that
this cannot be true.
  
% \begin{description} 
{\bf The Theorem \/}: For $d \ge 3$, there is
  no function $v:\ffzd{p^{2}}\rightarrow\mathscr{L}_{2}$ such that
\begin{eqnarray}
 & \bullet & \textrm{For any orthogonal basis }\left\{
  \left|n\right\rangle \right\}
  _{n=0}^{d-1}\subset\ffzd{p^{2}}\textrm{, }\nonumber \\ & &
  \textrm{exactly one of }\left\{ v\left(\left|n\right\rangle
  \right)\right\} _{n=0}^{d-1}
  \text{ is possible.}
  \label{enu:total-probability-DQT(I)-KS}
\end{eqnarray}
%\end{description}

\begin{table*}
\begin{tabular}{|c|c|c|c|c|c|}
\hline Possible & \multicolumn{4}{c|}{Impossible} & The first vector
is possible because of\tabularnewline \hline $001$ & $100$ & $010$ &
$110$ & $1\bar{1}0$ & arbitrary choice of $z$ axis\tabularnewline
\hline $101$ & $\bar{1}01$ & $010$ & & & arbitrary choice of $x$ vs
$-x$\tabularnewline \hline $011$ & $0\bar{1}1$ & $100$ & & & arbitrary
choice of $y$ vs $-y$\tabularnewline \hline $1\bar{1}{-}$ &
$\bar{1}1{-}$ & $110$ & ${+}0\bar{1}$ & $0{+}1$ & arbitrary choice of
$x$ vs $y$\tabularnewline \hline $10{-}$ & ${+}0\bar{1}$ & $010$ &
${+}\bar{1}\bar{1}$ & & orthogonality to 2nd and 3rd
vectors\tabularnewline \hline ${+}11$ & $0\bar{1}1$ &
${+}\bar{1}\bar{1}$ & $\bar{1}0{-}$ & & orthogonality to 2nd and 3rd
vectors\tabularnewline \hline ${+}01$ & $010$ & $\bar{1}0{-}$ &
$\bar{1}\bar{1}{-}$ & & orthogonality to 2nd and 3rd
vectors\tabularnewline \hline $11{-}$ & $1\bar{1}0$ &
$\bar{1}\bar{1}{-}$ & $0{+}\bar{1}$ & & orthogonality to 2nd and 3rd
vectors\tabularnewline \hline $01{-}$ & $100$ & $0{+}\bar{1}$ &
$\bar{1}{+}\bar{1}$ & & orthogonality to 2nd and 3rd
vectors\tabularnewline \hline $1{+}1$ & $\bar{1}01$ &
$\bar{1}{+}\bar{1}$ & $0\bar{1}{-}$ & & orthogonality to 2nd and 3rd
vectors\tabularnewline \hline
\end{tabular}\protect\caption{\label{tab:proof-of-K-S}Proof of the Kochen-Specker theorem in DQT(I)(I)
in 3 dimensions.}
\end{table*}

\begin{proof}

  Following the general structure in~\cite{peres1995quantum}, we will
  prove by contradiction that the theorem holds for primes (with
  $p \equiv 3 \mod 4$) with $p > 3$ ~\footnote{\label{fn:p>3}When
    $p=3$, the Kochen-Specker theorem still holds, but the proof is
    longer.}. Suppose $v$ exists, and consider the set of all vectors
  with entries in $\left\{ 0,\pm1,\pm1\pm\rmi\right\} $. Then the
  steps in the proof can be read off from Table
  \ref{tab:proof-of-K-S}.  In each cell in Table
  \ref{tab:proof-of-K-S}, the string $xyz$ represents a state vector,
  where $x$, $y$, and $z$ can be \{ $0$, $1$, $\bar{1}\equiv -1,$
  ${+} \equiv (1+\rmi)$, ${-} \equiv (1-\rmi)$ \}, and
\[
v\left( xyz \right)= \{\textrm{possible}\, \mbox{\it or\/}\,
\textrm{impossible} \ , \]
depending on its column.  Examining the table from top to the bottom,
we will eventually get a contradiction.  The set of vectors are
invariant under interchanges of the $x$, $y$, and $z$ axess.  Hence,
we can assume
$v\left(100\right)=v\left(010\right)=\textrm{impossible}$ and
$v\left(001\right)=\textrm{possible}$.  Furthermore, $110$ and
$1\bar{1}0$ are orthogonal to $001$, so that
$v\left(110\right)=v\left(1\bar{1}0\right)=\textrm{impossible}$.  A
similar argument may be used to construct the second, third, and
fourth rows.  After we know enough values of
$v\left(\ket{\Psi}\right)$, we can find that $10{-}$, ${+}0\bar{1}$,
and $010$ is an orthogonal basis, and we already know that
$v\left({+}0\bar{1}\right)=v\left(010\right)=\textrm{impossible}$, so
$v\left(10{-}\right)=\textrm{possible}$.  Following a similar
procedure, we can continue evaluating the entire content of Table
\ref{tab:proof-of-K-S}.  We can see that $100$, $0{+}1$, and
$0\bar{1}{-}$ form an orthogonal basis, but we already know
$v\left(100\right)=v\left(0{+}1\right)=v\left(0\bar{1}{-}\right)
=\textrm{impossible}$.
This contradicts our initial assumptions. Therefore, there is no
function $v$ satisfying the conditions.
\end{proof}
Notice that this proof applies for almost all $p$, and, despite
the exclusive appearance of integers in $\ff{p^{2}}$ throughout the
computation, there are no occurrences of wrapping back to zero in the
number field.

%%%%%%%%%%%%%%%%%
\subsection {Bell's Theorem in DQT}

We conclude with a discrete quantum theory version of Bell's theorem,
showing that non-locality persists in the discrete theory, and no
hidden variable theories are consistent with our modal-logic-valued
operations.  We exploit methods such as those of Greenberger, Horne,
and Zeilinger~\cite{GHZ1990} that do not rely on inequalities, and so
allow us to escape the disadvantages of lack of orderability of
discrete field values (see, e.g, \cite{MerminPRL1990,peres1995quantum}).

First, let $\mathbb{O}_{p^{2}}^{d}$ be the set of all observables for
$\ff{p^{2}}^{d}$, and let $\Delta\left(\mathcal{O}\right)$ be the set
of eigenvalues of an observable~$\mathcal{O}$. Then, the Born rule in
DQT(I) $\dpr $ asserts that given $\ket{\Psi}\in\ffzd{p^{2}}$ and an
observable~$\mathcal{O}\in\mathbb{O}_{p^{2}}^{d}$ whether a
eigenvalue~$\lambda\in\Delta\left(\mathcal{O}\right)$ is a possible
measurement result or not. Hence, a hidden variable theories
consistent with $\dpr $ can be described by a function~$w$ giving
directly the measurement result~$\lambda=w(\ket{\Psi},\mathcal{O})$
and satisfying condition (\ref{eq:consistent}).
\begin{eqnarray}
 & \bullet & \textrm{For any }\ket{\Psi}\in\ffzd{p^{2}}\textrm{, }\mathcal{O}\in\mathbb{O}_{p^{2}}^{d}\textrm{, }\nonumber \\
 &  & w(\ket{\Psi},\mathcal{O})\in\Delta\left(\mathcal{O}\right)\textrm{. Moreover, }\nonumber \\
 &  & \textrm{if }\mathcal{H}\textrm{ is an eigenspace of }\mathcal{O}\textrm{ corresponding to }w\left(\ket{\Psi},\mathcal{O}\right)\textrm{, }\nonumber \\
 &  & \textrm{then }\dpr \left(\ket{\Psi},\mathcal{H}\right)=\textrm{possible .}\label{eq:consistent}
\end{eqnarray}

Second, local observables $\mathcal{O}'$ and $\mathcal{O}''$ are
represented by the observables in subspace $\mathbb{O}_{p^{2}}^{d'}$
and $\mathbb{O}_{p^{2}}^{d''}$ and be considered as observables in the
whole space by applying tensor product, $\mathcal{O}'\otimes Id_{d''}$
and $Id_{d'}\otimes\mathcal{O}''$. Then, condition (\ref{eq:locality})
\begin{eqnarray}
 & \bullet & \textrm{For any }d',d''\in\N\textrm{, }d=d'd''\textrm{, }\mathcal{O}'\in\mathbb{O}_{p^{2}}^{d'}\textrm{, }\mathcal{O}''\in\mathbb{O}_{p^{2}}^{d''}\textrm{. }\nonumber \\
 &  & \textrm{If }\mathcal{H}'\textrm{ is an eigenspace of }\mathcal{O}'\otimes Id_{d''}\textrm{, }\nonumber \\
 &  & \textrm{and }\mathcal{H}''\textrm{ is an eigenspace of }Id_{d'}\otimes\mathcal{O}''\textrm{, }\nonumber \\
 &  & \textrm{and }\dpr \left(\ket{\Psi},\mathcal{H}'\right)=\textrm{possible ,}\nonumber \\
 &  & \textrm{then }w\left(\ket{\Psi},\mathcal{H}''\right)=w\left(\hat{P}_{\mathcal{H}'}\ket{\Psi},\mathcal{H}''\right)\textrm{. }\label{eq:locality}
\end{eqnarray}
represents locality because we require the measurement result of $Id_{d'}\otimes\mathcal{O}''$
should be the same no matter whether we apply the other observable
$\mathcal{O}'\otimes Id_{d''}$ which may be far away from $Id_{d'}\otimes\mathcal{O}''$.
\begin{description}
\item [{Theorem}] For $8\mid d$, there is no function $w:\ffzd{p^{2}}\times\mathbb{O}_{p^{2}}^{d}\rightarrow\ff{p}$
satisfying condition (\ref{eq:consistent}) and (\ref{eq:locality}).
\end{description}
\begin{proof}Suppose the function $w$ exists, we are going to construct
a contradiction form a (non-normalized) GHZ state~$\ket{\Psi_{4}}=4\ket{000}-4\ket{111}$,
where $\ket{xyz}$ are a three qubit state $\ket{x}\otimes\ket{y}\otimes\ket{y}$,
$x$, $y$, $z\in\left\{ 0,1\right\} $. Then we consider observables
representing the $j$-th experimenter measuring the spin along the
$\mu$-axis, the Pauli operators acting on the $j$-th spin~$\sigma_{\mu}^{j}$,
where $\mu=x,y$, and 
\begin{equation}
\sigma_{\mu}^{j}=\overbrace{\mathds{1}\otimes\mathds{1}\otimes\cdots\otimes\underbrace{\sigma_{\mu}}_{j^{th}\ \mbox{factor}}\otimes\cdots\otimes\mathds{1}}^{n\ \mbox{factors}}\;,\label{pauli3}
\end{equation}
with 
\[
\sigma_{x}=\left(\begin{array}{cc}
0 & 1\\
1 & 0
\end{array}\right),\sigma_{y}=\left(\begin{array}{cc}
0 & -i\\
i & 0
\end{array}\right).
\]

Suppose the first experimenter perform measurement on the first qubit
along the $x$-axis, and the other experiments perform measurement on
the other qubits along the $y$-axis, their measurements are actually
associated with observables $\sigma_{x}^{1}$, $\sigma_{y}^{2}$, and
$\sigma_{y}^{3}$. Because $\sigma_{x}^{1}$, $\sigma_{y}^{2}$, and
$\sigma_{y}^{3}$ are commuting, the product
observables~$\sigma_{x}^{1}\sigma_{y}^{2}\sigma_{y}^{3}$ used to be
considered in the proof in CQT~\cite{MerminPRL1990,peres1995quantum}.
However, as we discussed, we may not guarantee commuting observables
are compatible and can be measured simultaneously. Therefore, if we
want to consider the product of measurement result
$\sigma_{x}^{1}\sigma_{y}^{2}\sigma_{y}^{3}$, it is better to consider
$3!=6$ possible orders of measurements, to do these measurements
sequentially, and to multiply the measurement results after the
measurement process complete.

Assume the first experimenter measures first, and so on. By the
definition of $\dpr $ and the von Neumann measurement postulate, we
can represent the whole process in Figure
\ref{fig:possible-worlds-graph-2}, where each
arrow~$\ket{\Psi}\overset{\lambda}{\rightarrow}\ket{\Psi'}$ is from a
pre-measurement state~$\ket{\Psi}$ to a possible post-measurement
state~$\ket{\Psi'}$, labeled by the measurement result
eigenvalue~$\lambda$ on the row labeled by the observable
$\mathcal{O}$. By the von Neumann measurement postulate, the possible
post-measurement state~$\ket{\Psi'}$ is
$\hat{P}_{\mathcal{O}=\lambda}\ket{\Psi}$, where
$\hat{P}_{\mathcal{O}=\lambda}$ is the projector on the eigenspace of
$\lambda$. By the condition (\ref{eq:consistent}), the existence of
arrow~$\ket{\Psi}\overset{\lambda}{\rightarrow}\ket{\Psi'}$ implies
that $w\left(\ket{\Psi},\mathcal{O}\right)=\lambda$ is possible;
conversely, we must have
$w\left(\ket{\Psi},\mathcal{O}\right)\ne\lambda$ if there is no
arrow~$\ket{\Psi}\overset{\lambda}{\rightarrow}\ket{\Psi'}$.

\begin{figure*}
$\xymatrix@R=0pt{ &  &  &  & \ket{\Psi_{4}}\ar[ddll]_{1}\ar[ddrr]^{-1}\\
\sigma_{x}^{1}\\
 &  & \ket{\Psi_{+}}\ar[ddl]_{1}\ar[ddr]^{-1} &  &  &  & \ket{\Psi_{-}}\ar[ddl]_{-1}\ar[ddr]^{1}\\
\sigma_{y}^{2}\\
 & \ket{\Psi_{++}}\ar[dd]^{1} &  & \ket{\Psi_{+-}}\ar[dd]^{-1} &  & \ket{\Psi_{--}}\ar[dd]^{1} &  & \ket{\Psi_{-+}}\ar[dd]^{-1}\\
\sigma_{y}^{3}\\
 & \ket{\Psi_{+++}} &  & \ket{\Psi_{+--}} &  & \ket{\Psi_{--+}} &  & \ket{\Psi_{-+-}}
}
$

\begin{eqnarray*}
\ket{\Psi_{+}} & = & \hat{P}_{\sigma_{x}^{1}=1}\ket{\Psi_{4}}\\
\ket{\Psi_{-}} & = & \hat{P}_{\sigma_{x}^{1}=-1}\ket{\Psi_{4}}\\
\ket{\Psi_{++}} & = & \hat{P}_{\sigma_{y}^{2}=1}\hat{P}_{\sigma_{x}^{1}=1}\ket{\Psi_{4}}\\
\ket{\Psi_{+-}} & = & \hat{P}_{\sigma_{y}^{2}=-1}\hat{P}_{\sigma_{x}^{1}=1}\ket{\Psi_{4}}\\
\ket{\Psi_{-+}} & = & \hat{P}_{\sigma_{y}^{2}=1}\hat{P}_{\sigma_{x}^{1}=-1}\ket{\Psi_{4}}\\
\ket{\Psi_{--}} & = & \hat{P}_{\sigma_{y}^{2}=-1}\hat{P}_{\sigma_{x}^{1}=-1}\ket{\Psi_{4}}\\
\ket{\Psi_{+++}} & = & \hat{P}_{\sigma_{y}^{3}=1}\hat{P}_{\sigma_{y}^{2}=1}\hat{P}_{\sigma_{x}^{1}=1}\ket{\Psi_{4}}\\
\ket{\Psi_{+--}} & = & \hat{P}_{\sigma_{y}^{3}=-1}\hat{P}_{\sigma_{y}^{2}=-1}\hat{P}_{\sigma_{x}^{1}=1}\ket{\Psi_{4}}\\
\ket{\Psi_{-+-}} & = & \hat{P}_{\sigma_{y}^{3}=-1}\hat{P}_{\sigma_{y}^{2}=1}\hat{P}_{\sigma_{x}^{1}=-1}\ket{\Psi_{4}}\\
\ket{\Psi_{--+}} & = & \hat{P}_{\sigma_{y}^{3}=1}\hat{P}_{\sigma_{y}^{2}=-1}\hat{P}_{\sigma_{x}^{1}=-1}\ket{\Psi_{4}}
\end{eqnarray*}
\protect\caption{\label{fig:possible-worlds-graph-2}A measurement series start from
a (non-normalized) GHZ state $\ket{\Psi_{4}}$, and perform measurement
associated with observables $\sigma_{x}^{1}$, $\sigma_{y}^{2}$,
and $\sigma_{y}^{3}$ consecutively. }
\end{figure*}
After we draw Figure \ref{fig:possible-worlds-graph-2}, by the locality
condition (\ref{eq:locality}), we know 
\[
w\left(\ket{\Psi_{4}},\sigma_{y}^{2}\right)=w\left(\hat{P}_{\sigma_{x}^{1}=1}\ket{\Psi_{4}},\sigma_{y}^{2}\right)
\]
and so on. Therefore, no matter what measurement results are in Figure
\ref{fig:possible-worlds-graph-2}, the product of measurement results
always satisfies 
\begin{equation}
w\left(\ket{\Psi_{4}},\sigma_{x}^{1}\right)w\left(\ket{\Psi_{4}},\sigma_{y}^{2}\right)w\left(\ket{\Psi_{4}},\sigma_{y}^{3}\right)=1\label{eq:xyy}
\end{equation}
By the same reason, no matter which measurement order among $\sigma_{x}^{1}$,
$\sigma_{y}^{2}$, and $\sigma_{y}^{3}$, the product of measurement
result is always $1$. If we apply the similar method on other triad
observables, we can get 
\begin{eqnarray}
w\left(\ket{\Psi_{4}},\sigma_{y}^{1}\right)w\left(\ket{\Psi_{4}},\sigma_{x}^{2}\right)w\left(\ket{\Psi_{4}},\sigma_{y}^{3}\right) & = & 1\label{eq:yxy}\\
w\left(\ket{\Psi_{4}},\sigma_{y}^{1}\right)w\left(\ket{\Psi_{4}},\sigma_{y}^{2}\right)w\left(\ket{\Psi_{4}},\sigma_{x}^{3}\right) & = & 1\label{eq:yyx}\\
w\left(\ket{\Psi_{4}},\sigma_{x}^{1}\right)w\left(\ket{\Psi_{4}},\sigma_{x}^{2}\right)w\left(\ket{\Psi_{4}},\sigma_{x}^{3}\right) & = & -1\label{eq:xxx}
\end{eqnarray}
However, there is no way to assign $w\left(\ket{\Psi_{4}},\sigma_{\mu}^{j}\right)=1$
or $-1$ to satisfying the equation (\ref{eq:xyy}), (\ref{eq:yxy}),
(\ref{eq:yyx}), and (\ref{eq:xxx}). Therefore, there is no function
$w$.\end{proof}%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}

We have shown that by replacing state vectors and continuous probabilities
introduced in the conventional quantum mechanical arguments for
Gleason's theorem and related theorems invalidating hidden variable
theories by vectors in the discrete field $\ffzd{p^{2}}$ and a modal
logic-valued Born Rule, all the basic properties needed for a quantum
theory that is distinct from classical theory, forbidding hidden
variables, can be recovered.

\andy{Need to close with an assessment of the Mayer-Mermin discussion
  about the validity of the KS theorem in a world with finite
  resources and precision.}

\section*{References}

\bibliographystyle{iopart-num}
\bibliography{discreteGBKS}

\end{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{enumerate}
\item Possible or impossible needed, if then inconsistent requires extends. 
\item At first assume non-degenerate for clarity, but degenerate state will
play an important rule in final analysis.
\item Review of CQT notation with pointers to DQT glitches. 
\end{enumerate}
\item Elementary tests, e.g., yes/no questions, are represented by projectors
in a complex vector space <cite Peres>
\begin{equation}
\hat{P}_{\mathcal{H}_{n}}\equiv\sum_{g_{n}=0}^{d_{n}-1}\frac{\left|n^{g_{n}}\right\rangle \bra{n^{g_{n}}}}{\ip{n^{g_{n}}}{n^{g_{n}}}}\textrm{ ,}\label{eq:projection-1}
\end{equation}
where 
\begin{equation}
{\cal O}\,\left|n^{g_{n}}\right\rangle =\lambda_{n}\left|n^{g_{n}}\right\rangle \textrm{ .}
\end{equation}
 allow degenerate extension to 
\begin{equation}
{\cal O}\,\left|n\right\rangle =\lambda_{n}\left|n\right\rangle \textrm{ .}
\end{equation}
where the set labeled by $\dpr _{n}$ has same eigenvalue $\lambda_{n}$.\end{itemize}

