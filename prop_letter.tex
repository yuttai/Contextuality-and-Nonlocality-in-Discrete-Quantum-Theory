\documentclass[english,reprint, aps, prl,superscriptaddress, showpacs,
showkeys, longbibliography, amsmath, amssymb, floatfix]{revtex4-1} 
\usepackage{fullpage}
\usepackage{cmap}
\usepackage[T1,T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{babel}
\usepackage{amsthm}
\usepackage{mathrsfs}
\usepackage{bbold}
\usepackage{wesa}
\usepackage{graphicx}
\usepackage{verbatim}
\usepackage[backref=false]{hyperref}
\usepackage{booktabs}
\usepackage{multirow}

\theoremstyle{plain}
\newtheorem{thm}{Theorem}
\newtheorem{lemma}{Lemma}[thm]
\newtheorem{cor}{Corollary}[thm]
\newtheorem{assumption}{Assumption}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem*{example*}{Example}
\newtheorem{condition}[assumption]{Condition}

\newcommand{\Hilb}{\mathcal{H}}
\newcommand{\events}{\ensuremath{\mathcal{E}}}
\newcommand{\qevents}{\ensuremath{\mathcal{E}}}
\newcommand{\pmeas}{\ensuremath{\mu}}
\newcommand{\imposs}{{\text{\wesa{impossible}}}}
\newcommand{\likely}{{\text{\wesa{likely}}}}
\newcommand{\unlikely}{{\text{\wesa{unlikely}}}}
\newcommand{\necess}{{\text{\wesa{certain}}}}
\newcommand{\unknown}{{\text{\wesa{unknown}}}}
\newcommand{\midd}{{\text{\wesa{middle}}}}
\usepackage[braket,qm]{qcircuit}
\newcommand{\fket}[1]{{|#1\rangle}}
\newcommand{\fproj}[1]{|#1\rangle\langle #1|}
\newcommand{\proj}[1]{\op{#1}{#1}}
\newcommand{\ps}{\texttt{+}}
\newcommand{\ms}{\texttt{-}}

\usepackage{color}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{framed}
\newcommand{\amr}[1]{\begin{framed}\begin{minipage}{0.9\linewidth}\color{green}{Amr says: #1}\end{minipage}\end{framed}}
\newcommand{\yutsung}[1]{\begin{framed}\begin{minipage}{0.9\linewidth}\color{purple}{Yu-Tsung says: #1}\end{minipage}\end{framed}}
\newcommand{\set}[2]{\ensuremath{\left\{ {#1}~\middle|~{#2}\right\} }}
\newcommand{\Tr}{\ensuremath{\mathop{\mathrm{Tr}}\nolimits}}
\allowdisplaybreaks
\newcommand{\coreBorn}{\ensuremath{\overline{\Hilb}}}
\newcommand{\mul}[1][]{\ensuremath{\mu^{\mathrm{L{#1}}}}}
\newcommand{\mur}[1][]{\ensuremath{\mu^{\mathrm{R{#1}}}}}
\setcounter{secnumdepth}{3}
% https://tex.stackexchange.com/questions/345284/can-i-have-an-almost-non-breaking-space-in-latex
% Change non-breaking space to \nolinebreak[1] 
% Hence, it will not hyphenate too much surrounding words.
\newcommand{\rmd}{\mathrm{d}}
\newcommand{\rmi}{\mathrm{i}}

\begin{document}

\title{Quantum Interval-Valued Probability: Contextuality and the Born Rule}

\author{Yu-Tsung Tai}
\affiliation{Department of Mathematics, Indiana University, Bloomington, Indiana 47405,
USA}
\affiliation{Department of Computer Science, Indiana University, Bloomington,
Indiana 47405, USA}

\author{Andrew J Hanson}
\affiliation{Department of Informatics, Indiana University, Bloomington,
Indiana 47405, USA}

\author{Gerardo Ortiz}
\affiliation{Department of Physics, Indiana University, Bloomington, Indiana 47405,
USA}

\author{Amr Sabry}
\affiliation{Department of Computer Science, Indiana University, Bloomington,
Indiana 47405, USA}

\date{\today}

\begin{abstract}
We present a mathematical framework based on quantum interval-valued
probability measures to study the effect of experimental imperfections
and finite precision measurements on defining aspects of quantum
mechanics such as contextuality and the Born rule. While foundational
results such as the Kochen-Specker and Gleason theorems fail to hold
in general in a world with limited resources, when we allow infinite
precision, their validity is recovered.  However, we are able to use
the interval-valued framework to establish bounds on the validity of
those theorems in realistic experimental environments. In this way,
not only can we quantify the idea of finite-precision measurement
within our theory, but we can also suggest a possible resolution of
the Meyer-Mermin debate on the impact of finite-precision measurement
on the Kochen-Specker theorem.
\end{abstract}

\pacs{ % https://publishing.aip.org/publishing/pacs/pacs-2010-regular-edition
03.65.Ta, 03.67.-a, 02.50.Cw, 02.50.Le}

% \keywords{Finite precision measurement, the Born rule, Gleason's
% theorem, the Kochen-Specker theorem, interval-valued probability measure,
% discrete quantum theory}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}

There are long-standing debates in the foundations of quantum
mechanics regarding the tension between finite precision measurement
and contextuality~\cite{BarrettKent2004,Appleby_2005}. The outcome
of a theory that is contextual depends upon
whether  compatible sets of observables are measured together or
separately; a non-contextual theory gives the same results in either
case.  A classic example of the varying opinions on the impact of
imprecision is the disagreement between
Meyer~\cite{PhysRevLett.83.3751} and 
Mermin~\cite{Mermin1999}  on whether finite-precision
measurements invalidate the spirit of the Kochen-Specker
theorem~\cite{kochenspecker1967,Redhead1987-REDINA,peres1995quantum,Jaeger2007,Held2016}.  The Kochen-Specker  
theorem is in essence a
mathematical statement about contextuality, asserting that
in a Hilbert space of dimension $d \ge 3$, it is
impossible to associate definite measured values, $\mu(P_i)= 0$ or
$1$, with every projection operator~$P_i$, in such a way that, if a
set of commuting $P_i$ satisfies $\sum_i P_i = 1$, then
$\sum_i \mu(P_i) = 1$.   Meyer showed that one {\it can\/}
assign definite values $0$ or~$1$ to the measurement outcome
$\mu(P_i)$ when the Hilbert space is defined over the field of
rational numbers, therefore nullifying the
theorem~\citep{PhysRevLett.83.3751}.  However, Mermin then argued
that measurement outcomes must depend smoothly on slight changes in
the experimental configuration, leading him to assert that the
impact of Meyer's negative result is
``unsupportable''~\citep{Mermin1999}.  The debate on
whether contextuality is consistent with experimental
outcomes continues to be an active topic of research~\citep{Kent1999,HavlicekKrennSummhammerSvozil2001,SimonBruknerZeilinger2001,Cabello2002,Larsson2002,Appleby2002,BarrettKent2004,Appleby_2005,Spekkens2005,GuehneKleinmannCabelloEtAl2010,MazurekPuseyKunjwalEtAl2016}.

The question of how to address this controversy is therefore a
fundamental problem.  How does one
develop mathematical theories of quantum mechanics that are
intrinsically, rather than only implicitly, consistent with the
resources available for the realistic accuracy of an actual
measurement?   In this paper, we extend our previous work on the
foundations of computability in quantum physics by exploring the
application of interval-valued probability measures (IVPMs) to
achieving a coherent formulation of finite-resource quantum mechanics.
From this starting point, we develop a mathematical framework that includes the
uncertainties of finite precision and imperfections in the quantum
measurement process.  In particular, we are able to quantify the concept of
imperfect quantum measurement and its impact on the interpretation of
the Kochen-Specker and Gleason theorems and their implications for the
foundations of quantum mechanics.  We have reason to believe that
essential objectives of our program to achieve a computable theory of
quantum mechanics and finite-resource measurement, attempted
previously with computable number
systems~\cite{usat,geometry2013apsrev4,DQT2014}, may be achievable by
extending classical IVPMs~\cite{JamisonLodwick2004} to the quantum
domain.  We thus begin by axiomatizing a quantum interval-valued
probability measure (QIVPM) framework.

A principal result is that recasting the Kochen-Specker theorem in
terms of ``$\delta$-determinism'', with~$\delta$ quantifying the
effect of finite-precision uncertainties on measurement outcomes,
reducing to the purely deterministic Kochen-Specker case for
$\delta=0$, can resolve the question of the effect of finite precision
and imperfections on contextuality.  A remarkable consequence of our
analysis is that not only does the quantum-mechanical requirement for
contextuality continue to hold, thus maintaining the Kochen-Specker
result for a \emph{non-vanishing} range of $\delta$, but that at a
\emph{certain fixed value} of $\delta$, there is a sharp transition,
parallel in its consequences to, say, a phase transition, to
\emph{non-contextuality}; that is, suddenly a quantum system can be
simulated by a non-contextual hidden variable theory, turning the
system effectively from a quantum system into a classical system. 
% that is, quantum mechanics suddenly fails to hold, and all variables
% can be specified simultaneously, turning the theory effectively into a
% classical theory that can be specified consistently by hidden
% variables.
% \yutsung{The part after ``that is''
%   looks strange.
% \begin{enumerate}
% \item The Kochen-Specker theorem is not about quantum mechanics, is about whether
% quantum mechanics can be simulated by a non-contextual deterministic hidden
% variable theory or not. Hence, ``quantum mechanics suddenly fails to hold''
% doesn't make a lot sense.
% \item The question is whether there exist a QIVPM means ``a classical theory
% consistently by hidden variables.'' At least, a QIVPM is not deterministic, and
% I need to check whether it qualities as a classical probabilistic hidden variable
% theory\ldots(?)
% \end{enumerate}
% }
\yutsung{Still not comfortable about the current statement...}
These results provide a new insight into the Meyer-Mermin debate by
presenting a theory in which there is a \emph{parameter} interpolating
between what appeared previously to be irreconcilable interpretations
of contextuality.

We also investigate, though with less insight-generating results, the
second key aspect of imprecise quantum measurement, which is its
statistical nature as reflected in the application of the Born rule
determining the probability of a given measurement
outcome~\citep{Born1983,peres1995quantum,544199}.  Here, Gleason's
theorem establishes that there is no alternative to the Born rule by
demonstrating, using reasonable continuity arguments in Hilbert spaces
of dimension $d\ge3$, the existence of a unique state $\rho$
consistent with the statistical predictions computed from that
rule~\citep{gleason1957,Redhead1987-REDINA,peres1995quantum}.  Our
question then concerns what happens when infinite precision cannot be
achieved.  We are able to show that, while a QIVPM incorporating the
effects of finite precision might not be consistent with Gleason's
unique state~$\rho$ on all projectors defined on a Hilbert space
$\Hilb$ of dimension $d\ge3$, there is a mathematically precise sense
in which one recovers the original Gleason theorem asymptotically.
Specifically, if a set of QIVPMs representing bounded resources
correspond individually to at least one state's~$\rho'$, those states
will converge to a unique state $\rho$ in the limit as the size of the intervals
characterizing the uncertainties goes to zero, and the set of
single-point QIVPMs densely covers the entire real interval $[0,1]$ or the
appropriate subset corresponding to a given quantum system.


The paper is organized as follows.  In Sec.~\ref{sec:fuzzy} we begin
by introducing the foundations of quantum probability space and fuzzy
measurement.  We then move on to introduce the concept of quantum
interval valued probability in Sec.~\ref{sec:Interval-Uncertainty}.
The QIVPMs will provide the mathematical framework we need to quantify the
impact of finite precision measurements on quantum mechanics.  For
instance, in Sec.~\ref{sec:Kochen-Specker}, we quantify the domain of
validity of a contextual measurement, thus addressing the conditions
under which the Kochen-Specker theorem applies.  This provides a way
not only of resolving the Meyer-Mermin debate, but also revealing a
precise transition to non-contextuality;  these are the results of our
Thm~\ref{cor:Kochen-Specker-IVPM}.  In Sec.~\ref{sec:Gleason}, we
study Gleason's theorem in the context of imprecise measurements,
concluding that QIVPMs provide a framework with quantitative bounds in
which Gleason's theorem, while formally invalid in a universe with
bounded resources, holds asymptotically in a mathematically precise
way.  Finally, we present our conclusions in Sec.~\ref{sec:Conclusion}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fuzzy Measurements}
\label{sec:fuzzy}

A \emph{probability space} is a mathematical abstraction specifying
the necessary conditions for reasoning coherently about collections of
uncertain
events~\cite{Kolmogorov1950,544199,Griffiths2003,Grabisch2016}. In the
quantum case, the events of interest are specified by \emph{projection
  operators} $P$. These include the empty projector~$\mathbb{0}$, the
identity projector~$\mathbb{1}$, projectors of the form $\proj{\phi}$
where $\ket{\phi}$ is a pure quantum state (an element of a Hilbert
space), sums of \emph{orthogonal} projectors $P_0$ and~$P_1$ with
$P_0P_1=\mathbb{0}$, and products of \emph{commuting} projectors $P_0$
and~$P_1$ with $P_0P_1=P_1P_0$. In a quantum probability
space~\cite{10.2307/2308516,gleason1957,Redhead1987-REDINA,Maassen2010},
each event~$P_{i}$ is mapped to a probability~$\mu(P_{i})$ using a
probability measure~$\mu:\events\rightarrow[0,1]$, where $\events$ is
the set of all projectors on a given Hilbert space, subject to the
following constraints: $\mu(\mathbb{0})=0$, $\mu(\mathbb{1})=1$,
$\mu\left(\mathbb{1}-P\right)=1-\mu\left(P\right)$, and for each pair
of \emph{orthogonal} projectors $P_{0}$ and $P_{1}$:
\begin{equation}
{\mu}\left(P_{0}+P_{1}\right)={\mu}\left(P_{0}\right)+{\mu}\left(P_{1}\right)\,.\label{eq:QuantumProbability-Addition}
\end{equation}
Given a probability for every projector, we can define the
expectation value of an observable~$\mathbf{O}$ having spectral
decomposition $\mathbf{O}=\sum_{i=1}^{N}\lambda_{i}P_{i}$ as:
\begin{equation}
\expval{\mathbf{O}}_{\mu}=\sum_{i=1}^{N}\lambda_{i}\mu(P_{i})\,.\label{eq:quantum-expectation}
\end{equation}

A conventional quantum probability measure can easily be
constructed using the Born rule if one knows the current state of the quantum
system.  Specifically, for each pure normalized quantum
state~$\ket{\phi}$, the Born rule induces a probability measure
$\mu_{\phi}^{\mathrm{B}}$ defined as
$\mu_{\phi}^{\mathrm{B}}(P)=\ip{\phi}{P\vert\phi}$. The situation
generalizes to mixed states
$\rho = \sum_{j=1}^{N}q_{j}\proj{\phi_{j}}$, where
$\sum_{j=1}^{N}q_{j}=1$, in which case the generalized Born rule
induces a probability measure $\mu_{\rho}^{\mathrm{B}}$ defined as
$\mu_{\rho}^{\mathrm{B}}\left(P\right) = \Tr\left(\rho P\right) =
\sum_{j=1}^{N}
q_{j}\mu_{\phi_{j}}^{\mathrm{B}}\left(P\right)$~\cite{peres1995quantum,544199,Jaeger2007}.

As an example, consider a three-dimensional Hilbert space with orthonormal
basis $\{\ket{0},\ket{1},\ket{2}\}$ and an observable $\mathbf{O}$
with spectral decomposition $\mathbf{O}=\proj{0}+2\,\proj{1}+3\,\proj{2}$,
i.e., $\lambda_{i}=i$ and $P_{i}=\proj{i-1}$. Two fragments of valid
probability measures~$\mu_{1}$ and $\mu_{2}$ that can be associated
with this space are defined in Table~\ref{tab:quantum-probability-measure}.
\begin{table}
\noindent \centering{}\caption{\label{tab:quantum-probability-measure}Two fragments of valid probability
measures~$\mu_{1}$ and $\mu_{2}$.}
\begin{tabular}{ccc}
\toprule 
\addlinespace
$\ket{\psi}$ & $\mu_{1}(\proj{\psi})$ & $\mu_{2}(\proj{\psi})$\tabularnewline\addlinespace
\midrule
\midrule 
\addlinespace
$\ket{0}$ & $\frac{1}{2}$ & $\frac{1}{2}$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\ket{1}$ & $\frac{1}{2}$ & $0$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\ket{2}$ & $0$ & $\frac{1}{2}$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\ket{\ps}=\frac{\ket{0}+\ket{1}}{\sqrt{2}}$ & $1$ & $\frac{1}{4}$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\ket{\rmi}=\frac{\ket{0}+\rmi\ket{1}}{\sqrt{2}}$ & $\frac{1}{2}$ & $\frac{1}{4}$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\ket{\ps'}=\frac{\ket{0}+\ket{2}}{\sqrt{2}}$ & $\frac{1}{4}$ & $\frac{1}{2}$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\ket{\rmi'}=\frac{\ket{0}+\rmi\ket{2}}{\sqrt{2}}$ & $\frac{1}{4}$ & $\frac{1}{2}$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\ket{\ps''}=\frac{\ket{1}+\ket{2}}{\sqrt{2}}$ & $\frac{1}{4}$ & $\frac{1}{4}$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\ket{\rmi''}=\frac{\ket{1}+\rmi\ket{2}}{\sqrt{2}}$ & $\frac{1}{4}$ & $\frac{1}{4}$\tabularnewline\addlinespace
\bottomrule
\end{tabular}
\end{table}
By the Born rule, the first probability measure corresponds to the
quantum system being in the pure state $\ket{\ps}=(\ket{0}+\ket{1})/\sqrt{2}$
and the second corresponds to the quantum system being in the state
$\rho=(\proj{0}+\proj{2})/2$. The expectation values of the observable
$\mathbf{O}$, $\expval{\mathbf{O}}_{\mu_{1,2}}$, are 1.5 in the
first case and 2 in the second.

The above axioms describe a mathematical idealization involving
infinitely precise measurements. In an actual experimental setup with
an ensemble of quantum states that are not exactly identically
prepared, and with small imperfections and inaccuracies in measuring
devices, an experimenter might only be able to determine that the
probability of the event $\proj{0}$ is concentrated in the range $[0.49,0.51]$
instead of precisely 0.5. The spread in this range depends on the
amount of resources (time, energy, money, etc.) that are devoted to
the experiment. In the classical setting, this ``fuzziness'' can be
formalized by moving to \emph{interval-valued probability measures}
(IVPMs), which we explore in the next section, along with our proposed
extension to the quantum domain.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Intervals of Uncertainty}
\label{sec:Interval-Uncertainty}

We will start by reviewing IVPMs in the classical setting and then
propose our quantum generalization. In the classical setting, there
are several proposals for ``imprecise
probabilities''~\citep{Dempster1967,Shafer1976,GilboaSchmeidler1994,Marinacci1999,Weichselberger2000,JamisonLodwick2004,HuberRonchetti2009,Grabisch2016}.
Although these proposals differ in some details, they all share the
fact that the probability $\mu(E)$ of an event~$E$ is generalized from
a single \emph{real number} to an \emph{interval}~$[\ell,r]$
where~$\ell$ intuitively corresponds to the strength of evidence for
the event~$E$ and~$1-r$ corresponds to the strength of evidence
against the same event. More generally, this inverval would be interpreted as
the Guassian width of a probability distribution, but for notational convenience
we will continue in the following to write this as a definite interval.
\yutsung{Check the interpretation in the statistics literature~\citep{HuberRonchetti2009}!
Or we may need to prove it could be interpreted as Guassian width
by ourselves...} The collection of intervals used in the
definition of a probability measure must satisfy certain properties
that we explain next.

First, for each interval $[\ell,r]$ we have the natural constraint
$0 \leq \ell \leq r \leq 1$ that guarantees that every element of the
interval can be interpreted as a conventional probability. We also
include $\imposs=[0,0]$ and $\necess=[1,1]$ as limiting intervals to
refer to the probability of impossible events (e.g., the null event)
and events that are certain (e.g., the event covering the entire
sample space).  For each interval $[\ell,r]$, we also need the dual
interval $[1-r,1-\ell]$ so that if one interval refers to the
probability of an event~$E$, the dual refers to the probability of the
event's complement $\overline{E}$.  For example, if we discover as a
result of an experiment that $\mu(E) = [0.2,0.3]$ for some event~$E$,
we may conclude that $\mu(\overline{E}) = [0.7,0.8]$ for the
complementary event $\overline{E}$. In addition to these simple
conditions, there are some subtle conditions on how intervals are
combined, which we discuss next.

Let $E_1$ and $E_2$ be two disjoint events with probabilities
$\mu(E_1)=[\ell_1,r_1]$ and $\mu(E_2)=[\ell_2,r_2]$. A first attempt
at calculating the probability of the combined event that
\emph{either} $E_1$ or $E_2$ occurs might be
$\mu(E_1\cup E_2) = [\ell_1+\ell_2,r_1+r_2]$. In some cases, this is
indeed a sensible definition. For example, if $\mu(E_1)=[0.1,0.2]$ and
$\mu(E_2)=[0.3,0.4]$ we get $\mu(E_1\cup E_2) = [0.4,0.6]$. But
consider an event $E$ such that $\mu(E)=[0.2,0.3]$ and hence
$\mu(\overline{E})=[0.7,0.8]$. The two events $E$ and $\overline{E}$
are disjoint; the naïve addition of intervals would give
$\mu(E\cup\overline{E})=[0.9,1.1]$ which is not a valid probability
interval. Moreover the event $E\cup\overline{E}$ is the
entire space; its probability interval should be
$\necess$ which is sharper than $[0.9,1.1]$. The problem is that the
two intervals are correlated: there is more information in the
combined event than in each event separately. In our example, even
though the ``true'' probability of $E$ can be anywhere in the range
$[0.2,0.3]$ and the ``true'' probability of~$\overline{E}$ can be in
anywhere in the range $[0.7,0.8]$, the values are not independent. Any
value of $\mu(E) \leq 0.25$ will force $\mu(\overline{E})\geq
0.75$. To account for such subtleties, the axioms of interval-valued
probability do not use a strict equality for the combination of
disjoint events. The correct constraint regarding the probability of
$E_1\cup E_2$ when $E_1$ and $E_2$ are disjoint is
$\mu(E_1\cup E_2) \subseteq [\ell_1+\ell_2,r_1+r_2]$ which, in
combination with the requirement for the event of the entire space would force
$\mu(E \cup \overline{E})$ to always be $\necess$ irrespective of the
particular assignments of $\mu(E)$ or~$\mu(\overline{E})$. Parallel arguments
can be made interpreting $[\ell,r]$ as Gaussian width, but will be omitted as no
essential new information seems to be introduced.

When combining non-disjoint events, there is a further subtlety whose
resolution will give us the final general condition for IVPMs. For
general, not necessarily disjoint, events $E_1$ and $E_2$, we have:
\begin{equation}
\mu(E_1\cup E_2) + \mu(E_1\cap E_2) \subseteq \mu(E_1) + \mu(E_2)
\label{eq:classicalconvex}
\end{equation}
which is a generalization of the classical inclusion-exclusion
principle that uses $\subseteq$ instead of $=$ for the same reason as
before. The new condition, known as
\emph{convexity}~\cite{Shapley1971,GilboaSchmeidler1994,Marinacci1999,Grabisch2016},
reduces to the previously
motivated condition when the events are disjoint, i.e., when
$\mu(E_1\cap E_2) = 0$.

We now have the necessary ingredients to define the quantum extension,
QIVPMs, as a generalization of both classical IVPMs and quantum
probability measures. We will show that QIVPMs reduce to classical
IVPMs when the space of quantum events is restricted to mutually
commuting events, i.e., to compatible events that can be measured
simultaneously. In Sec.~\ref{sec:Gleason} we will discuss the
connection between QIVPMs and conventional quantum probability
measures.

\begin{definition}[QIVPM]
  Assume a collection of intervals $\mathscr{I}$ including $\imposs$
  and $\necess$ with addition and scalar multiplication defined as
  follows:
  \begin{subequations}\label{eq:interval-operations}
  \begin{eqnarray}
   &  & [\ell_{1},r_{1}]+[\ell_{2},r_{2}]=[\ell_{1}+\ell_{2},r_{1}+r_{2}]\textrm{ and}\\
   &  & x[\ell,r]=\begin{cases}
  [x\ell,xr] & \textrm{for }x\ge0\,;\\{}
  [xr,x\ell] & \textrm{for }x\le0\,.
  \end{cases}
  \end{eqnarray}
  \end{subequations}
  Then we take a QIVPM~$\bar{\mu}$ to be an assignment of an interval to each
  event (projection operator~$P$) subject to the following constraints:
  \begin{subequations}\label{eq:QIVPM-constraints}
  \begin{eqnarray}
   &  & \bar{\mu}(\mathbb{0})=\imposs\,,\\
   &  & \bar{\mu}(\mathbb{1})=\necess\,,\label{eq:necess}\\
   &  & \bar{\mu}\left(\mathbb{1}-P\right)= \necess -\bar{\mu}\left(P\right)\,,
  \end{eqnarray}
  \end{subequations}
  and satisfying for each pair of \emph{commuting} projectors~$P_0$
  and~$P_1$ with $P_0P_1=P_1P_0$,
\begin{equation}
\bar{\mu}\left(P_{0}+P_{1}-P_{0}P_{1}\right)+\bar{\mu}\left(P_{0}P_{1}\right)\subseteq\bar{\mu}\left(P_{0}\right)+\bar{\mu}\left(P_{1}\right)\,.
\label{eq:QuantumInterval-valuedProbability-Inclusion}
\end{equation}
\end{definition}
\noindent The first three constraints,
Eqs.~(\ref{eq:QIVPM-constraints}), are the direct counterpart of the
corresponding ones for classical IVPMs.  With the understanding that
the union of classical sets $E_1\cup E_2$ is replaced by
$P_0+P_1-P_0P_1$ in the case of quantum projection
operators~\cite{Griffiths2003}, the last condition,
Eq.~(\ref{eq:QuantumInterval-valuedProbability-Inclusion}), is a
direct counterpart of the convexity condition of
Eq.~(\ref{eq:classicalconvex}). Thus our definition of QIVPMs merges
classical IVPMs with quantum probability measures. 

In the remainder of this section, we will show that our definition of
QIVPMs is consistent with classical IVPMs in the sense that a
restriction of QIVPMs to commuting events recovers the definition of
classical IVPMs. To formalize this connection between QIVPMs and
classical IVPMs, we first note that in contrast to the case with
conventional quantum probability spaces, there is generally no unique
state~$\rho$ consistent with a QIVPM. We say that a QIVPM $\bar{\mu}$
is consistent with a state $\rho$ and projector~$P$ if the interval
$\bar{\mu}(P)$ contains the exact probability calculated by the Born
rule, i.e, if:
\begin{equation}
\mu_{\rho}^{\mathrm{B}}\left(P\right)\in\bar{\mu}\left(P\right)
\end{equation}
where $\mu_{\rho}^{\mathrm{B}}\left(P\right)=\Tr\left(\rho P\right)$
is the probability that the event~$P$ is determined by the Born
rule~\citep{Born1983,peres1995quantum,544199}.

We generalize this consistency relation to sets of states and general
subspaces of events as follows. A set of events $\events'$ is a
\emph{subspace} if it contains $\mathbb{0}$ and~$\mathbb{1}$ and is
closed under complements, sums, and product, i.e., for any projector~$P\in\events'$,
we have $\mathbb{1}-P\in\events'$ and for each pair of commuting
projectors~$P_{0}\in\events'$ and $P_{1}\in\events'$, we have $P_{0}+P_{1}-P_{0}P_{1}$
and $P_{0}P_{1}\in\events'$. Given a
probability measure $\bar{\mu}$ and a subspace of events $\events'$,
we denote the collection of all states that are consistent with
$\bar{\mu}$ on every projector in $\events'$ as
$\coreBorn(\bar{\mu},\events')$:
\begin{equation}
\label{eq:hbar}
\coreBorn\left(\bar{\mu},\events'\right)=\set{\rho}{\forall P\in \events',~\mu_{\rho}^{\mathrm{B}}\left(P\right)\in\bar{\mu}\left(P\right)}.
\end{equation}

The proof that QIVPMs become classical IVPMs when the space of events
includes only mutually commuting events is presented in detail in the
long version of this paper~\cite{HOSTunpublished}. The idea of the
proof is as follows. Given a subspace of commuting events~$\events_C$,
we can construct a partial orthonormal basis by diagonalization and
complete it to a full orthonormal basis $\overline{\events_C}$. We
then build a bijection between the QIVPM on the set of projectors
associated with this basis and the set of classical events
corresponding to this basis. This correspondence leads to a crucial
property in our setting.

\begin{thm}[Non-empty Core for Compatible Measurements] \label{thm:Shapley}
  For QIVPM~$\bar{\mu}:\events\rightarrow\mathscr{I}$, if a subspace
  of events~$\events_C\subseteq\events$ commutes, then
  $\coreBorn\left(\bar{\mu},\events_C\right)\ne\emptyset$.
\end{thm}

This theorem follows directly from our
correspondence~\cite{HOSTunpublished} and Shapley's
theorem~\cite{Shapley1971,GilboaSchmeidler1994,Grabisch2016}, which
proves that a classical IVPM always contains at least one state $\rho$
that is consistent with every event in $\events_C$. In contrast, as we
illustrate in Sec.~\ref{sec:Gleason}, the set of states
$\coreBorn\left(\bar{\mu},\events'\right)$ that is consistent with
some arbitrary (not necessarily commuting) events $\events'$ and a
particular QIVPM $\bar{\mu}$ may be \emph{empty}.

For example, a well-defined  
QIVPM, assuming the three intervals $\imposs$, $\necess$, and
$\unknown=\left[0,1\right]$, is:
\begin{equation}
\bar{\mu}_{1}\left(P\right)=\begin{cases}
\imposs\,, & \text{if }P=\mathbb{0}\text{ ;}\\
\necess\,, & \text{if }P=\mathbb{1}\text{ ;}\\
\unknown\,, & \text{otherwise.}
\end{cases}\label{eq:no-information-IVPM}
\end{equation}
This measure represents the beliefs of an experimenter with no prior
knowledge about the particular quantum system in question; any quantum
state would be consistent with $\bar{\mu}_{1}$ on any projectors, and
$\coreBorn\left(\bar{\mu}_{1},\events\right)$ is just the set of all
states. The subspace
$\events_{0}=\left\{ \mathbb{0},\proj{0},\proj{1},\mathbb{1}\right\} $
is a subspace of commuting events. Indeed restricting $\bar{\mu}_{1}$
to $\events_{0}$, $\bar{\mu}_{1}|_{\events_{0}}$, gives a classical
IVPM~$\bar{\mu}_{2}$:
\begin{equation}
\begin{aligned}\bar{\mu}_{2}(\mathbb{0}) & =\imposs & \bar{\mu}_{2}(\proj{0}) & =\unknown\\
\bar{\mu}_{2}(\mathbb{1}) & =\necess & \bar{\mu}_{2}(\proj{1}) & =\unknown
\end{aligned}
\label{eq:classical-no-information-IVPM}
\end{equation}
If we identify the states ~$\proj{0}$ and $\proj{1}$ with the head
and the tail of a coin, respectively, then $\bar{\mu}_{2}$ represents
the situation in which an experimenter knows nothing about a coin
before she tosses it. Moreover, for each $p\in\left[0,1\right]$, the
state~$p\proj{0}+\left(1-p\right)\proj{1}$ represents a classical
coin with probability~$p$ to get heads, and
$p\proj{0}+\left(1-p\right)\proj{1}$ is consistent with
$\bar{\mu}_{2}$ on $\events_{0}$ because any classical coin should be
consistent with the situation for which an experimenter has no prior
knowledge.

We conclude this section with a generalization of expectation values
of observables in the context of QIVPMs. In conventional quantum
mechanics the expectation value of an observable as defined in
Eq.~\eqref{eq:quantum-expectation} is a unique real number. The
generalization to QIVPMs implies that this expectation value will
itself become bounded by or, more generally distributed around, an interval. 

\begin{definition}[Expectation Value of Observables over QIVPMs] Let
  $\mathscr{I}$ be a set of intervals; $\Hilb$ a Hilbert space
  with event space~$\events$; and $\mathbf{O}$ an
  observable with spectral decomposition
  $\Sigma_{i=1}^N \lambda_iP_i$. Let $\events'$ be the minimal
  subspace of events containing all the projectors $P_i$ in the
  spectral decomposition of $\mathbf{O}$ and define:
\begin{equation}
\expval{\mathbf{O}}_{\bar{\mu}}=\left[\min_{\rho\in\coreBorn\left(\bar{\mu},\events'\right)}
\expval{\mathbf{O}}_{\mu_{\rho}^{\mathrm{B}}},\max_{\rho\in\coreBorn\left(\bar{\mu},\events'\right)}
\expval{\mathbf{O}}_{\mu_{\rho}^{\mathrm{B}}}\right]\,. \label{eq:quantum-interval-expectation-core}
\end{equation}
\end{definition}

\noindent Intuitively the expectation value of an observable relative
to a QIVPM $\bar{\mu}$ lies between two possible outcomes, which
themselves lie between the minimum and maximum bounds of the probability
intervals associated with each state~$\rho$ that is consistent with
$\bar{\mu}$ on every projector in the spectral decomposition of the
observable. If $\bar{\mu}$ is a conventional (Born) probability measure
induced by a state $\rho$, then the Born rule probability induced
by every state in $\coreBorn\left(\bar{\mu},\events'\right)$ will
be $\mu_{\rho}^{\mathrm{B}}$ and the interval collapses to a point,
thus reducing the definition to that of Eq.~(\ref{eq:quantum-expectation})~\citep{HOSTunpublished}.
For example, we can extend one of the fragments of valid probability
measures~$\mu_{1}$ defined in Table~\ref{tab:quantum-probability-measure}
to a QIVPM~$\bar{\mu}_{3}$:
\begin{equation}
\begin{aligned}\bar{\mu}_{3}(\proj{0}) & =\left[\tfrac{1}{2},\tfrac{1}{2}\right] & \bar{\mu}_{3}(\proj{2}) & =\left[0,0\right]\\
\bar{\mu}_{3}(\proj{1}) & =\left[\tfrac{1}{2},\tfrac{1}{2}\right] &  & \ldots\textrm{ etc.}
\end{aligned}
\label{eq:Born-QIVPM}
\end{equation}
For the same observable~$\mathbf{O}=\proj{0}+2\,\proj{1}+3\,\proj{2}$,
the only state~$\rho$ consistent with $\bar{\mu}_{3}$ on $\proj{0}$,
$\proj{1}$, and $\proj{2}$ must be $\proj{\ps}$, and $\mu_{1}=\mu_{\proj{\ps}}^{\mathrm{B}}$.
Therefore, the expectation value~$\expval{\mathbf{O}}_{\bar{\mu}_{3}}=\left[\expval{\mathbf{O}}_{\mu_{1}},\expval{\mathbf{O}}_{\mu_{1}}\right]=\left[1.5,1.5\right]$
which is an interval, but not between $0$ and $1$ because it is
not a probability of an event. We also note that, when restricted
to commuting projectors, the definition above is consistent with the
classical notion of the \emph{Choquet integral}~\citep{GilboaSchmeidler1994,Grabisch2016}
which is used to calculate the expectation value of random variables
as a weighted average~\citep{HOSTunpublished}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Kochen-Specker} 
\label{sec:Kochen-Specker}
  
Our generalization of quantum probability measures to QIVPMs allows us
to strengthen the scope of one of the fundamental theorems of quantum
information: the Kochen-Specker
theorem~\cite{kochenspecker1967,Redhead1987-REDINA,peres1995quantum,Jaeger2007,Held2016}. Our
finite-precision extension of the theorem will suggest a resolution to
the debate initiated by Meyer and Mermin on the relevance of the
Kochen-Specker to experimental, and hence finite-precision, quantum
measurements~\citep{PhysRevLett.83.3751,Mermin1999,Kent1999,HavlicekKrennSummhammerSvozil2001,SimonBruknerZeilinger2001,Cabello2002,Larsson2002,Appleby2002,BarrettKent2004,Appleby_2005,Spekkens2005,GuehneKleinmannCabelloEtAl2010,MazurekPuseyKunjwalEtAl2016}.
Specifically, the original Kochen-Specker theorem is formulated
using a model quantum mechanical system that
has \emph{definite values at all times}~\cite{Held2016}, i.e., they
have infinitely precise values at all times. Our interval-valued
probability framework will allow us to state, and prove, a stronger
version of the theorem that holds even if the observables have values
that are only definite up to some precision specified by a parameter
$\delta$. Our approach provides a quantitative realization of
Mermin's intuition~\citep{Mermin1999}:
\begin{quote}
  \ldots although the outcomes deduced from such imperfect
  measurements will occasionally differ dramatically from those
  allowed in the ideal case, if the misalignment is very slight, the
  statistical distribution of outcomes will differ only slightly from
  the ideal case.
\end{quote}

%\paragraph*{$\delta$-Determinism.} 

The first step in our formalization is to introduce a family of QIVPMs
parameterized by an uncertainty~$\delta$, which we call
$\delta$-deterministic QIVPMs.

\begin{definition}[$\delta$-Determinism]\label{def:delta-deterministic} A
  QIVPM~$\bar{\mu}:\events\rightarrow\mathscr{I}$ is
  $\delta$-deterministic if, for every event $P\in\events$, we have
  that either 
  $\bar{\mu}\left(P\right)\subseteq\left[0,\delta\right]$ or
  $\bar{\mu}\left(P\right)\subseteq\left[1-\delta,1\right]$. 
\end{definition}

\noindent The definition puts no restrictions on the choice of intervals,
only on the assignment of intervals to events. When $\delta=0$, every
event must be assigned a probability either in the interval $\imposs$
or in $\necess$, i.e., every event is completely determined with
certainty. As $\delta$ gets larger, the QIVPM allows for more indeterminate
behavior. To illustrate the examples easier, we restrict ourselves
to the classical subspace of commuting events~$\events_{0}=\left\{ \mathbb{0},\proj{0},\proj{1},\mathbb{1}\right\} $.
If we apply the same definition in the classical case, the classical
IVPM~$\bar{\mu}_{4}$ defined in Table~\ref{tab:classical-IVPMs}
is $0$-deterministic because $\imposs\subseteq\left[0,0\right]$
and $\necess\subseteq\left[1-0,1\right]$.
\begin{table}
\noindent \centering{}\caption{\label{tab:classical-IVPMs}Classical IVPMs~$\bar{\mu}_{4}$, $\bar{\mu}_{5}$
and $\bar{\mu}_{6}$ on $\events_{0}$.}
\begin{tabular}{cccc}
\toprule 
\addlinespace
$P$ & $\bar{\mu}_{4}(P)$ & $\bar{\mu}_{5}(P)$ & $\bar{\mu}_{6}(P)$\tabularnewline\addlinespace
\midrule
\midrule 
\addlinespace
$\mathbb{0}$ & $\imposs$ & $\imposs$ & $\imposs$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\proj{0}$ & $\necess$ & $\left[\frac{1}{3},1\right]$ & $\left[\frac{2}{3},\frac{2}{3}\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\proj{1}$ & $\imposs$ & $\left[0,\frac{1}{3}\right]$ & $\left[\frac{1}{3},\frac{1}{3}\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\mathbb{1}$ & $\necess$ & $\necess$ & $\necess$\tabularnewline\addlinespace
\bottomrule
\end{tabular}
\end{table}
By interpreting the states ~$\proj{0}$ and $\proj{1}$ with the
head and the tail of a coin again, $\bar{\mu}_{4}$ represents tossing
a double-headed coin which can be predicted with certain. When $\delta$
is increased to $\frac{1}{3}$, the classical IVPMs~$\bar{\mu}_{5}$
and $\bar{\mu}_{6}$ defined in Table~\ref{tab:classical-IVPMs}
are clearly $\frac{1}{3}$-deterministic, and they have more indeterminate
behavior than $\bar{\mu}_{4}$. However, the most indeterminate classical
IVPM~$\bar{\mu}_{2}$ defined in Eq.~(\ref{eq:classical-no-information-IVPM})
is still not $\frac{1}{3}$-deterministic because $\bar{\mu}_{2}(\proj{0})=\bar{\mu}_{2}(\proj{1})=\unknown$,
but neither $\unknown\subseteq\left[0,\frac{1}{3}\right]$ nor $\unknown\subseteq\left[1-\frac{1}{3},1\right]$.
Finally, when $\delta=1$, because every interval is a subset of $\unknown$,
every QIVPM is $1$-deterministic. In particular, the non-informative
QIVPM~$\bar{\mu}_{1}$ defined in Eq.~(\ref{eq:no-information-IVPM})
and the Born QIVPM~$\bar{\mu}_{3}$ defined in Eq.~(\ref{eq:Born-QIVPM})
are both $1$-deterministic.

The expectation value of an observable relative to a 0-deterministic
QIVPM is fully determinate and is equal to one of the eigenvalues of
that observable. To see this, note that given an orthonormal basis
$\Omega=\{ \ket{\psi_0},\ket{\psi_1},\ldots\}$, a 0-deterministic
QIVPM must map exactly one of the projectors $\proj{\psi_i}$ to
$\necess$ and all others to $\imposs$. This is because by
Eq.~(\ref{eq:necess}), we have
$\bar{\mu}(\Sigma_i{\proj{\psi_i}})=\necess$ and by inductively applying
Eq.~(\ref{eq:QuantumInterval-valuedProbability-Inclusion}), we must have
one of the $\bar{\mu}(\proj{\psi_i})=\necess$ and all others mapped to
$\imposs$. Given any state~$\rho$ that is consistent with this QIVPM
on all the projectors in $\Omega$, we have by Eq.~(\ref{eq:hbar}) that
$\mu_{\rho}^{\mathrm{B}}$ must also map exactly one of the projectors
in $\Omega$ to 1 and all others to 0. If an observable has a spectral
decomposition along $\Omega$ then, by
Eq.~(\ref{eq:quantum-expectation}), its expectation value relative to
$\mu_{\rho}^{\mathrm{B}}$ is the eigenvalue $\lambda$ whose projector
is mapped to 1. It therefore follows, by
Eq.~(\ref{eq:quantum-interval-expectation-core}), that the expectation
value relative to the 0-deterministic~${\bar{\mu}}$ is fully
determinate and lies in the interval $[\lambda,\lambda]$.

We can now proceed with our technical result, which is that the
original Kochen-Specker theorem is a statement regarding the
non-existence of $0$-deterministic QIVPM. 

\begin{thm}[0-Deterministic Variant of
  Kochen-Specker] \label{thm:Kochen-Specker} Given a Hilbert space
  $\Hilb$ of dimension~$d\ge3$, there is no 0-deterministic
  measure~$\bar{\mu}$ mapping every event to either $\imposs$ or
  $\necess$.
\end{thm}

\noindent To explain why this result is equivalent to the original
Kochen-Specker theorem and to prove it at the same time, we proceed by
assuming a 0-deterministic QIVPM $\bar{\mu}$ and derive the same
contradiction as the original Kochen-Specker theorem. Instead of
adapting the more complicated proof for $d=3$, our counterexample uses
the simpler proof for a Hilbert space of dimension $d=4$ and is
constructed as follows.

We consider a 2-qubit Hilbert space $\Hilb=\Hilb_1\otimes\Hilb_2$
representing pairs of spin-$\frac{1}{2}$ states. We use the same nine
observables $\mathbf{O}_{ij}$ with $i$ and $j$ ranging over
$\{0,1,2\}$ from the ``Mermin-Peres'' proof of the Kochen-Specker
theorem~\cite{Mermin1990Simple,peres1995quantum}:

{\renewcommand{\arraystretch}{2}%
\begin{center}
\begin{tabular}{r|@{\quad}c@{\quad}|@{\quad}c@{\quad}|@{\quad}c@{\quad}|}
$\mathbf{O}_{ij}$~ & $j=0$ & $j=1$ & $j=2$ \\
\hline 
$i=0~$ & $\mathbb{1}\otimes\sigma_{z}$  & $\sigma_{z}\otimes\mathbb{1}$  & $\sigma_{z}\otimes\sigma_{z}$ \tabularnewline
\hline 
$i=1~$ & $\sigma_{x}\otimes\mathbb{1}$  & $\mathbb{1}\otimes\sigma_{x}$  & $\sigma_{x}\otimes\sigma_{x}$ \tabularnewline
\hline 
$i=2~$ & $\sigma_{x}\otimes\sigma_{z}$  & $\sigma_{z}\otimes\sigma_{x}$  & $\sigma_{y}\otimes\sigma_{y}$ \tabularnewline
\hline 
\end{tabular}\,,
\par\end{center}
} 

\noindent The observables are constructed using the Pauli matrices
$\left\{ \mathbb{1},\sigma_{x},\sigma_{y},\sigma_{z}\right\}$ whose
eigenvalues are all either 1 or $-1$. They are arranged such that in
each row and column, \emph{except the column $j=2$}, every observable
is the product of the other two. In the $j=2$ column, we have instead
that
$\left(\sigma_{z}\otimes\sigma_{z}\right)\left(\sigma_{x}\otimes\sigma_{x}\right)=-\sigma_{y}\otimes\sigma_{y}$. Now
assume a 0-deterministic QIVPM ${\bar{\mu}}$; the expectation values
of the observables in each row relative to this 0-deterministic QIVPM
are fully determinate and must lie in either the interval $[1,1]$ or
the interval $[-1,-1]$ depending on which eigenvalue is the one whose
associated projector is certain. Since the product of any two
observables in a row is equal to the third, there must be an even
number of occurrences of the interval $[-1,-1]$ in each row and hence
in the entire table~\citep{HOSTunpublished}. However, looking at the expectation values of the
observables in each column, there must be an even number of
occurrences of the interval $[-1,-1]$ in the first two columns and an
odd number in the $j=2$ column and hence in the entire table~\citep{HOSTunpublished}. The
contradiction implies the non-existence of the assumed 0-deterministic
QIVPM. We therefore prove a stronger statement of contextuality that
includes the effects of finite-precision.

% \begin{table*}
% \caption{\label{tab:Mermin-Peres-Computation}Compute the expectation value
% of of observables~$\ensuremath{\mathbb{1}\otimes\sigma_{z}}$, $\ensuremath{\sigma_{z}\otimes\mathbb{1}}$,
% and $\ensuremath{\sigma_{z}\otimes\sigma_{z}}$ relative to a 0-deterministic
% QIVPM~$\bar{\mu}$. During the computation, whenever $\rho\in\coreBorn\left(\bar{\mu},\events'\right)$,
% $\mu_{\rho}^{\mathrm{B}}\left(P_{1}\right)$ and $\mu_{\rho}^{\mathrm{B}}\left(P_{2}\right)$
% must be the value list in the table. Therefore, $\expval{\mathbf{O}}_{\bar{\mu}}$
% is a singleton set.}
% \begin{tabular}{|c|c|c|c|c|c|c|c|}
% \hline 
% Observable~$\mathbf{O}$ & Spectral Decomposition~$1\cdot P_{1}-1\cdot P_{2}$ & $\bar{\mu}\left(P_{1}\right)$ & $\bar{\mu}\left(P_{2}\right)$ & $\mu_{\rho}^{\mathrm{B}}\left(P_{1}\right)$ & $\mu_{\rho}^{\mathrm{B}}\left(P_{2}\right)$ & $\expval{\mathbf{O}}_{\mu_{\rho}^{\mathrm{B}}}$ & $\expval{\mathbf{O}}_{\bar{\mu}}$\tabularnewline
% \hline 
% \hline 
% $\ensuremath{\mathbb{1}\otimes\sigma_{z}}$ & $1\cdot\left(\proj{0}+\proj{2}\right)-1\cdot\left(\proj{1}+\proj{3}\right)$ & $\imposs$ & $\necess$ & $0$ & $1$ & $1\cdot0-1\cdot1=-1$ & $\left\{ -1\right\} $\tabularnewline
% \hline 
% $\ensuremath{\sigma_{z}\otimes\mathbb{1}}$ & $1\cdot\left(\proj{0}+\proj{1}\right)-1\cdot\left(\proj{2}+\proj{3}\right)$ & $\necess$ & $\imposs$ & $1$ & $0$ & $1\cdot1-1\cdot0=1$ & $\left\{ 1\right\} $\tabularnewline
% \hline 
% $\ensuremath{\sigma_{z}\otimes\sigma_{z}}$ & $1\cdot\left(\proj{0}+\proj{3}\right)-1\cdot\left(\proj{1}+\proj{2}\right)$ & $\imposs$ & $\necess$ & $0$ & $1$ & $1\cdot0-1\cdot1=-1$ & $\left\{ -1\right\} $\tabularnewline
% \hline 
% \end{tabular}
% \end{table*}
% \yutsung{In order to understand the expectation value of observables~$\ensuremath{\mathbb{1}\otimes\sigma_{z}}$,
% $\ensuremath{\sigma_{z}\otimes\mathbb{1}}$, and $\ensuremath{\sigma_{z}\otimes\sigma_{z}}$
% relative to a 0-deterministic QIVPM~$\bar{\mu}$, we first diagonalize
% these observables by the computational basis~$\Omega=\left\{ \ket{0},\ket{1},\ket{2},\ket{3}\right\} $,
% where $\ket{0}=\ket{0}\otimes\ket{0}$, $\ket{1}=\ket{0}\otimes\ket{1}$,
% $\ket{2}=\ket{1}\otimes\ket{0}$, and $\ket{3}=\ket{1}\otimes\ket{1}$.
% Since $\bar{\mu}$ is 0-deterministic, there is a unique $\ket{k_{0}}\in\Omega$
% such that $\bar{\mu}\left(\proj{k_{0}}\right)=\necess$ and $\bar{\mu}\left(\proj{k}\right)=\imposs$
% for $k\ne k_{0}$~\citep{HOSTunpublished}. Without loss of generality,
% assume $k_{0}=1$, the expectation values can be computed step-by-step
% in Table~\ref{tab:Mermin-Peres-Computation}. They are singleton
% sets whose only element is the eigenvalue of the observable. By adopting
% an intuitive product rule~$\left\{ x_{0}\right\} \cdot\left\{ x_{1}\right\} =\left\{ x_{0}x_{1}\right\} $
% for singleton sets, these expectation values also satisfy the property~$\expval{\ensuremath{\mathbb{1}\otimes\sigma_{z}}}_{\bar{\mu}}\cdot\expval{\ensuremath{\sigma_{z}\otimes\mathbb{1}}}_{\bar{\mu}}=\expval{\ensuremath{\sigma_{z}\otimes\sigma_{z}}}_{\bar{\mu}}$
% since $\left(\ensuremath{\mathbb{1}\otimes\sigma_{z}}\right)\cdot\left(\ensuremath{\sigma_{z}\otimes\mathbb{1}}\right)=\left(\ensuremath{\sigma_{z}\otimes\sigma_{z}}\right)$.}

% A 0-deterministic QIVPM~$\bar{\mu}$ has an important property
% regarding to the expectation values of a family of $M$ commuting
% observables~$\left\{ \mathbf{O}_{j}\right\} _{j=1}^{M}$ relative to
% $\bar{\mu}$. Since $\left\{ \mathbf{O}_{j}\right\} _{j=1}^{M}$
% commutes, they can be diagonalized by a common orthonormal
% basis~$\Omega=\left\{ \ket{k}\right\} _{k=0}^{d-1}$.  Since
% $\bar{\mu}$ is 0-deterministic, a unique $\ket{k_{0}}$ and a unique
% quantum probability measure~$\mu$ exists such that
% $\bar{\mu}\left(P\right)=\left\{ \mu\left(P\right)\right\} $ and
% $\mu\left(P\right)\in\left\{ 0,1\right\} $ for all $P\in\events$;
% $\mu\left(\proj{k}\right)=1$ if and only if
% $k=k_{0}$~\citep{HOSTunpublished}.  If we denote the product
% observables~$\prod_{j=1}^{M}\mathbf{O}_{j}$ as
% $\overline{\mathbf{O}}$, the expectation values of the
% observables~$\expval{\mathbf{O}_{j}}_{\bar{\mu}}$ and
% $\expval{\overline{\mathbf{O}}}_{\bar{\mu}}$ are equal to the
% singleton sets whose only elements are $\expval{\mathbf{O}_{j}}_{\mu}$
% and $\expval{\overline{\mathbf{O}}}_{\mu}$, respectively. Both
% $\prod_{j=1}^{M}\expval{\mathbf{O}_{j}}_{\mu}$ and
% $\expval{\overline{\mathbf{O}}}_{\mu}$ are equal to the product of the
% eigenvalues corresponding to the pure state~$\ket{k_{0}}$ for each
% observable~$\mathbf{O}_{j}$. By adopting an intuitive product
% rule~$\left\{ x_{0}\right\} \cdot\left\{ x_{1}\right\} =\left\{
%   x_{0}x_{1}\right\} $, we have the following property:
% \begin{equation}
% \prod_{j=1}^{M}\expval{\mathbf{O}_{j}}_{\bar{\mu}}=\expval{\prod_{j=1}^{M}\mathbF{O}_{j}}_{\bar{\mu}}\,.\label{eq:Kochen-Specker-Rules}
% \end{equation}

Our framework allows us to generalize the above theorem to state that
for small enough $\delta$, it is impossible to have
$\delta$-deterministic QIVPMs. We therefore prove a stronger statement of 
contextuality that includes the effects of finite-precision.
Every QIVPM must map some events to
truly uncertain intervals, not just ``almost definite intervals.'' The
significance of this observation is that the uncertainty in the
intervals is, in contrast to the classical case, \emph{a fundamental
  part of quantum theory}. There are in fact two sources of
uncertainty: one due to the finite measurement resources and one due
to complementarity, which requires every quantum framework to be truly
probabilistic.

\begin{thm}[Finite-precision Extension of Kochen-Specker] \label{cor:Kochen-Specker-IVPM} Given a Hilbert space $\Hilb$
  of dimension~$d\ge3$, there is no $\delta$-deterministic QIVPM for
  $\delta<\frac{1}{3}$.\end{thm}

The proof is by contradiction: Suppose there is a
$\delta$-deterministic
QIVPM~$\bar{\mu}:\events\rightarrow\mathscr{I}$. We claim that the
following
map~$\bar{\mu}^{\textrm{D}}:\events\rightarrow\left\{
  \imposs,\necess\right\} $ is a 0-deterministic QIVPM:
\begin{equation}
\bar{\mu}^{\textrm{D}}\left(P\right)=\begin{cases}
\imposs\,, & \textrm{ if }\bar{\mu}\left(P\right)\subseteq\left[0,\delta\right]\:;\\
\necess\,, & \textrm{ if }\bar{\mu}\left(P\right)\subseteq\left[1-\delta,1\right]\:.
\end{cases}
\end{equation}
However, since we know that 0-deterministic QIVPMs do not exist, the
map $\bar{\mu}^{\textrm{D}}$ cannot exist and hence $\bar{\mu}$ does
not exist.

It remains to verify that $\bar{\mu}^{\textrm{D}}$ is indeed a
0-deterministic QIVPM by checking~\citep{HOSTunpublished} that for orthogonal
operators~$P_{0}$ and $P_{1}$, we have that
$\bar{\mu}^{\textrm{D}}\left(P_{0}\right)=\bar{\mu}^{\textrm{D}}\left(P_{1}\right)=\imposs$
implies
$\bar{\mu}^{\textrm{D}}\left(P_{0}+P_{1}\right)=\imposs$. Indeed when
$\bar{\mu}^{\textrm{D}}\left(P_{0}\right)=\bar{\mu}^{\textrm{D}}\left(P_{1}\right)=\imposs$,
we have both $\bar{\mu}\left(P_{0}\right)$ and
$\bar{\mu}\left(P_{1}\right)\subseteq\left[0,\delta\right]$ which
implies
$\bar{\mu}\left(P_{0}+P_{1}\right)\subseteq\left[0,2\delta\right]$.
When $\delta<\frac{1}{3}$, i.e., $2\delta<1-\delta$, it follows that
$\bar{\mu}\left(P_{0}+P_{1}\right)$ cannot be a subset of
$\left[1-\delta,1\right]$, but $\bar{\mu}\left(P_{0}+P_{1}\right)$ is
a subset of either $\left[0,\delta\right]$ or
$\left[1-\delta,1\right]$.  Hence, $\bar{\mu}\left(P_{0}+P_{1}\right)$
must be a subset of $\left[0,\delta\right]$, which implies
$\bar{\mu}^{\textrm{D}}\left(P_{0}+P_{1}\right)=\imposs$. Thus the
theorem holds when $\delta<\frac{1}{3}$.

When $\delta \ge \frac{1}{3}$, the situation abruptly
changes. Assuming a Hilbert space $\Hilb$ of dimension $3$, then for
any projector $P$ that projects onto an $n$-dimensional subspace of
$\Hilb$, it is straightforward to check that
$\bar{\mu}\left(P\right)=\left[\frac{n}{3},\frac{n}{3}\right]$ is a valid
$\frac{1}{3}$-deterministic QIVPM. In other words, when the
uncertainty in measurements becomes so large, the Kochen-Specker
theorem no longer holds and it becomes possible to map every
observable to some (quite inaccurate) probability interval, and hence
the theory becomes non-contextual.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Gleason}

\label{sec:Gleason}

While the finite-precision extension of the Kochen-Specker theorem
asserts the non-existence of a certain kind of QIVPMs, we also want
to understand what a QIVPM could be when it exists. A conventional
quantum probability measure~$\mu$ can easily be constructed using
the Born rule when one knows the current state of the system~\citep{Born1983,peres1995quantum,544199,Jaeger2007}.
Gleason's theorem asserts that the only state consistent with $\mu$
on all projectors is the one used to construct $\mu$~\citep{gleason1957,Redhead1987-REDINA,peres1995quantum}.
In another word, the set of all quantum probability measures is one-to-one
corresponding to the set of states so that studying the set of states
is sufficient to understand all possible phenomenon regarding to quantum
probability. Although we can extend the Born rule to its finite precision
version easily, there are some subtleties extending Gleason's theorem.
If we only focus on the Born QIVPMs~$\bar{\mu}$, that is, QIVPM's
induced by a state~$\rho$ according to the Born rule, we find that
if we monotonically shrink the length of intervals, the states consistent
with $\bar{\mu}$ will be closer and closer to $\rho$, and vise visa.
However, there is a QIVPM such that no state can be consistent with
it on every projector. In another word, although the Born rule and
Gleason's theorem can be extended to consider finite precision measurement,
the problem of finite precision measurement itself is not limited
in just applying error analysis in experimental results, but it highlight
some new phenomenon regarding to the foundation of quantum machines,
and it is necessary to embedding the idea of the resources available
for realistic measurement into the formulation of quantum theory.

The first step toward a finite precision Born rule is to find a way
of replacing the computed probability by an interval. This can be
done by carefully picking a set of intervals and a rule to select
the correct interval when intervals are overlapping. For example,
consider the following collection of overlapping intervals: 
\begin{equation}
\begin{aligned}\mathscr{I}_{n}= & \set{\left[\tfrac{k-1}{2n},\tfrac{k+1}{2n}\right]\cap\left[0,1\right]}{k=0,\ldots,2n}\\
 & \cup\{\imposs,\necess\}
\end{aligned}
\end{equation}
which are overlapping intervals with length~$1/n$ except for the
intervals with length~$\left(2n\right)^{-1}$ at each end. As in
Table~\ref{tab:I_n}, to select the correct interval from these overlapping
intervals~$[\ell,r]$, we define the non-overlapping interior part
of a interval, $\textrm{Int}\left([\ell,r]\right)$.
\begin{table}
\caption{\label{tab:I_n}Intervals in $\mathscr{I}_{n}$, their lengths, and
their interiors, where $2\mid k$ means $k$ is even, and $2\nmid k$
means $k$ is odd. Although intervals~$[\ell,r]$ are overlapping,
their interior~$\textrm{Int}\left([\ell,r]\right)$ are non-overlapping.
See Table~\ref{tab:I_2} for a concrete example when $n=2$.}

\begin{tabular}{cccc}
\toprule 
\addlinespace
$k$ & $[\ell,r]$ & $r-\ell$ & $\textrm{Int}\left([\ell,r]\right)$\tabularnewline\addlinespace
\midrule
\midrule 
\addlinespace
 & $\imposs$ & $0$ & $\imposs$\tabularnewline\addlinespace
\midrule 
\addlinespace
$0$ & $\left[0,\tfrac{1}{2n}\right]$ & $\tfrac{1}{2n}$ & $\left(0,\tfrac{0.5}{2n}\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
\begin{tabular}{c}
$0<k<2n$\tabularnewline
and $2\nmid k$\tabularnewline
\end{tabular} & $\left[\tfrac{k-1}{2n},\tfrac{k+1}{2n}\right]$ & $\tfrac{1}{n}$ & $\left(\tfrac{k-0.5}{2n},\tfrac{k+0.5}{2n}\right)$\tabularnewline\addlinespace
\midrule 
\addlinespace
\begin{tabular}{c}
$0<k<2n$\tabularnewline
and $2\mid k$\tabularnewline
\end{tabular} & \multirow{1}{*}{$\left[\tfrac{k-1}{2n},\tfrac{k+1}{2n}\right]$} & $\tfrac{1}{n}$ & $\left[\tfrac{k-0.5}{2n},\tfrac{k+0.5}{2n}\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$2n$ & $\left[\tfrac{2n-1}{2n},1\right]$ & $\tfrac{1}{2n}$ & $\left[\tfrac{2n-0.5}{2n},1\right)$\tabularnewline\addlinespace
\midrule 
\addlinespace
 & $\necess$ & $0$ & $\necess$\tabularnewline\addlinespace
\bottomrule
\end{tabular}
\end{table}
 Table~\ref{tab:I_2} lists a special case $\mathscr{I}_{2}$ to
illustrate these intervals and their interior parts more clearly.
\begin{table}
\caption{\label{tab:I_2}Intervals in $\mathscr{I}_{2}$, , their lengths,
and their interiors. Although intervals~$[\ell,r]$ are overlapping,
their interior~$\textrm{Int}\left([\ell,r]\right)$ are non-overlapping.}

\begin{tabular}{cccc}
\toprule 
\addlinespace
$k$ & $[\ell,r]$ & $r-\ell$ & $\textrm{Int}\left([\ell,r]\right)$\tabularnewline\addlinespace
\midrule
\midrule 
\addlinespace
 & $\imposs$ & $0$ & $\imposs$\tabularnewline\addlinespace
\midrule 
\addlinespace
$0$ & $\left[0,\tfrac{1}{4}\right]$ & $\tfrac{1}{4}$ & $\left(0,\tfrac{1}{8}\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$1$ & $\left[0,{\textstyle \tfrac{1}{2}}\right]$ & $\tfrac{1}{2}$ & $\left(\tfrac{1}{8},\tfrac{3}{8}\right)$\tabularnewline\addlinespace
\midrule 
\addlinespace
$2$ & $\left[\tfrac{1}{4},\tfrac{3}{4}\right]$ & $\tfrac{1}{2}$ & $\left[\tfrac{3}{8},\tfrac{5}{8}\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$3$ & $\left[\tfrac{1}{2},1\right]$ & $\tfrac{1}{2}$ & $\left(\tfrac{5}{8},\tfrac{7}{8}\right)$\tabularnewline\addlinespace
\midrule 
\addlinespace
$4$ & $\left[\tfrac{1}{4},1\right]$ & $\tfrac{1}{4}$ & $\left[\tfrac{7}{8},1\right)$\tabularnewline\addlinespace
\midrule 
\addlinespace
 & $\necess$ & $0$ & $\necess$\tabularnewline\addlinespace
\bottomrule
\end{tabular}
\end{table}
 Then, given a real-valued probability~$x$, we will select the interval~$\iota_{n}\left(x\right)=[\ell,r]$
if $x\in\textrm{Int}\left([\ell,r]\right)$.

After we have the rule to replace a real number by an interval, we
can induce a QIVPM from a state according to the following theorem:

\begin{thm}[Finite-precision Extension of the Born rule]\label{thm:Finite-precision-Born}For
any state $\rho$ on a three-dimensional Hilbert space, $\iota_{n}\circ\mu_{\rho}^{\mathrm{B}}$
is a QIVPM, where $\circ$ is the function concatenation.\end{thm}

\noindent Since $\iota_{n}\circ\mu_{\rho}^{\mathrm{B}}$ clearly satisfies
Eqs.~(\ref{eq:QIVPM-constraints}), the condition really need to
be checked is Eq.~(\ref{eq:QuantumInterval-valuedProbability-Inclusion}).
Given $x_{0}$, $x_{1}$, and $x_{0}+x_{1}\in\left[0,1\right]$, it
is easy to verify that
\begin{equation}
\iota_{n}\left(x_{0}+x_{1}\right)\subseteq\iota_{n}\left(x_{0}\right)+\iota_{n}\left(x_{1}\right)\,.\label{eq:iota-add}
\end{equation}
This implies Eq.~(\ref{eq:QuantumInterval-valuedProbability-Inclusion})
when $P_{0}$ and $P_{1}$ are orthogonal. When $P_{0}$ and $P_{1}$
are not orthogonal on a three-dimensional Hilbert space, we have two
possibilities:
\begin{itemize}
\item Their complements are orthogonal so that we can apply Eq.~(\ref{eq:iota-add})
on their complements.
\item One of them projects onto a subspace of what the other one projects
onto.
\end{itemize}
\noindent No matter which case Eq.~(\ref{eq:QuantumInterval-valuedProbability-Inclusion})
can be deduced easily. Therefore, $\iota_{n}\circ\mu_{\rho}^{\mathrm{B}}$
is indeed a QIVPM.

As a concrete example of Thm.~\ref{thm:Finite-precision-Born}, when
$n=2$, two states~$\rho_{0}=\frac{1}{3}\cdot\proj{0}+\frac{1}{3}\cdot\proj{1}+\frac{1}{3}\cdot\proj{2}$
and $\rho_{1}=\frac{7}{24}\cdot\proj{0}+\frac{1}{3}\cdot\proj{1}+\frac{3}{8}\cdot\proj{2}$
can induce two QIVPMs~$\iota_{2}\circ\mu_{\rho_{0}}^{\mathrm{B}}$
and $\iota_{2}\circ\mu_{\rho_{1}}^{\mathrm{B}}$. Given any projector
$P$ in the minimal subspace of events containing $\proj{0}$, $\proj{1}$,
and $\proj{2}$, $\events_{C}$, the interval-valued probability of
the induced QIVPMs, $\iota_{2}\left(\mu_{\rho_{0}}^{\mathrm{B}}\left(P\right)\right)$
and $\iota_{2}\left(\mu_{\rho_{1}}^{\mathrm{B}}\left(P\right)\right)$,
can be computed straightforwardly in Table~\ref{tab:Compute-the-QIVPM}.
\begin{table}
\caption{\label{tab:Compute-the-QIVPM}Compute $\iota_{2}\circ\mu_{\rho_{0}}^{\mathrm{B}}$
and $\iota_{2}\circ\mu_{\rho_{1}}^{\mathrm{B}}$ based on $\mu_{\rho_{0}}^{\mathrm{B}}$
and $\mu_{\rho_{1}}^{\mathrm{B}}$ on $\events_{C}$.}

\begin{tabular}{ccccc}
\toprule 
\addlinespace
$P$ & $\mu_{\rho_{0}}^{\mathrm{B}}\left(P\right)$ & $\iota_{2}\left(\mu_{\rho_{0}}^{\mathrm{B}}\left(P\right)\right)$ & $\mu_{\rho_{1}}^{\mathrm{B}}\left(P\right)$ & $\iota_{2}\left(\mu_{\rho_{1}}^{\mathrm{B}}\left(P\right)\right)$\tabularnewline\addlinespace
\midrule
\midrule 
\addlinespace
$\mathbb{0}$ & $0$ & $\imposs$ & $0$ & $\imposs$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\proj{0}$ & $\frac{1}{3}$ & $\left[0,\frac{1}{2}\right]$ & $\frac{7}{24}$ & $\left[0,\frac{1}{2}\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\proj{1}$ & $\frac{1}{3}$ & $\left[0,\frac{1}{2}\right]$ & $\frac{1}{3}$ & $\left[0,\frac{1}{2}\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\proj{2}$ & $\frac{1}{3}$ & $\left[0,\frac{1}{2}\right]$ & $\frac{3}{8}$ & $\left[\tfrac{1}{4},\tfrac{3}{4}\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\mathbb{1}-\proj{2}$ & $\frac{2}{3}$ & $\left[\frac{1}{2},1\right]$ & $\frac{5}{8}$ & $\left[\tfrac{1}{4},\tfrac{3}{4}\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\mathbb{1}-\proj{1}$ & $\frac{2}{3}$ & $\left[\frac{1}{2},1\right]$ & $\frac{2}{3}$ & $\left[\frac{1}{2},1\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\mathbb{1}-\proj{0}$ & $\frac{2}{3}$ & $\left[\frac{1}{2},1\right]$ & $\frac{17}{24}$ & $\left[\frac{1}{2},1\right]$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\mathbb{1}$ & $1$ & $\necess$ & $1$ & $\necess$\tabularnewline\addlinespace
\bottomrule
\end{tabular}
\end{table}

In the limiting case when the intervals are infinitely precise, i.e.,
$\mathscr{I}_{\infty}=\set{\left[x,x\right]}{x\in\left[0,1\right]}$,
we can formulate Gleason's theorem in our framework as follow.

\begin{thm}[$\mathscr{I}_{\infty}$ Variant of Gleason]\label{cor:Gleason's}In
a Hilbert space $\Hilb$ of dimension $d\geq3$, given a QIVPM~$\bar{\mu}:\events\rightarrow\mathscr{I}_{\infty}$,
the states consistent with it on every projector, $\coreBorn\left(\bar{\mu},\events\right)$,
has a unique element. \end{thm}

Our framework allows us to generalize the above theorem to Born QIVPMs~$\iota_{n}\circ\mu_{\rho}^{\mathrm{B}}$:
The collection of states consistent $\iota_{n}\circ\mu_{\rho}^{\mathrm{B}}$
gets closer and closer to $\rho$ as the intervals get narrower and
narrower, eventually collapsing to $\rho$ when the intervals become
infinitely precise real numbers covering the real line. To state this
result, we introduce a few technical notions. We call a state~$\rho$
a \emph{totally mixed state} if $0<\mu_{\rho}^{\mathrm{B}}\left(P\right)<1$
for any $P\in\events\backslash\left\{ \mathbb{0},\mathbb{1}\right\} $.
For example, $\rho_{0}$ and $\rho_{1}$ are both totally mixed states,
but any pure state is not totally mixed. We also define a notion of
distance between two states~$\rho$ and $\rho'$ as $\left\Vert \rho-\rho'\right\Vert =\max_{\ip{\psi}{\psi}=1}\left|\melem{\psi}{\rho-\rho'}{\psi}\right|$~\citep{544199},
and the set of all states whose distance with $\rho$ is bounded by
$\epsilon$ is denoted by $B_{\epsilon}\left(\rho\right)=\set{\rho'}{\left\Vert \rho-\rho'\right\Vert \le\epsilon}$.
For example, since $\left\Vert \rho_{0}-\rho_{1}\right\Vert \le\frac{1}{24}$~\citep{HOSTunpublished},
we have $\rho_{0}\in B_{1/24}\left(\rho_{1}\right)$ and $\rho_{1}\in B_{1/24}\left(\rho_{0}\right)$.

Since we have enough definitions, we can replace the QIVPM~$\bar{\mu}$
in Thm.~\ref{cor:Gleason's} by a Born QIVPM~$\iota_{n}\circ\mu_{\rho}^{\mathrm{B}}$,
and estimate the states consistent with it by the following theorem.

\begin{thm}[Finite-precision Extension of Gleason's theorem for the
Born QIVPMs]\label{thm:Finite-precision-Gleason}In a Hilbert space
$\Hilb$ of dimension $3$, given any totally mixed state~$\rho$,
\begin{equation}
B_{\frac{1}{12n}}\left(\rho\right)\subseteq\coreBorn\left(\iota_{n}\circ\mu_{\rho}^{\mathrm{B}},\events\right)\subseteq B_{1/n}\left(\rho\right)\,.
\end{equation}
\end{thm}

\noindent In another word, if a state~$\rho'$ is consistent with
$\iota_{n}\circ\mu_{\rho}^{\mathrm{B}}$, the difference between the
Born quantum probabilities on any projector~$P$, $\left|\mu_{\rho_{0}}^{\mathrm{B}}\left(P\right)-\mu_{\rho_{1}}^{\mathrm{B}}\left(P\right)\right|$,
must be bounded by $1/n$ which is the maximal length of the intervals
in $\mathscr{I}_{n}$. So does the distance between $\rho$ and $\rho'$,
$\left\Vert \rho-\rho'\right\Vert $. Conversely, if the distance
between $\rho$ and $\rho'$ is bounded by $\frac{1}{12n}$, so does
the difference between their Born quantum probabilities on any 1-dimensioal
projector~$\proj{\psi}$, $\left|\mu_{\rho_{0}}^{\mathrm{B}}\left(\proj{\psi}\right)-\mu_{\rho_{1}}^{\mathrm{B}}\left(\proj{\psi}\right)\right|\le\frac{1}{12n}$.
Since the dimension of the Hilbert space is $3$, the same difference
on any projector~$P$, $\left|\mu_{\rho_{0}}^{\mathrm{B}}\left(P\right)-\mu_{\rho_{1}}^{\mathrm{B}}\left(P\right)\right|$,
is bounded by $\frac{1}{4n}$. Moreover, the interiors of the intervals
in $\mathscr{I}_{n}$ shrinks $\frac{0.5}{2n}$ from the both ends,
excepts $\imposs$, $\left[0,\tfrac{1}{2n}\right]$, $\left[\tfrac{2n-1}{2n},1\right]$,
and $\necess$. Together with the fact that $0<\mu_{\rho_{0}}^{\mathrm{B}}\left(P\right)<1$
and $0<\mu_{\rho_{1}}^{\mathrm{B}}\left(P\right)<1$, $\mu_{\rho_{0}}^{\mathrm{B}}\left(P\right)$
and $\mu_{\rho_{1}}^{\mathrm{B}}\left(P\right)$ are both in the same
intervals, and $\rho'$ is consistent with $\iota_{n}\circ\mu_{\rho}^{\mathrm{B}}$.

As a concrete example of Thm.~\ref{thm:Finite-precision-Gleason},
we should have $\rho_{1}\in\coreBorn\left(\widehat{\iota}_{2}\circ\mu_{\rho_{0}}^{\mathrm{B}},\events\right)$
and $\rho_{0}\in\coreBorn\left(\widehat{\iota}_{2}\circ\mu_{\rho_{1}}^{\mathrm{B}},\events\right)$,
and this is indeed the case for $P\in\events_{C}$ according to Table~\ref{tab:Compute-the-QIVPM}.
In general, as $n$ goes to infinity, only the state very close to
$\rho$ are guaranteed to belong to $\coreBorn\left(\widehat{\iota}_{2}\circ\mu_{\rho_{0}}^{\mathrm{B}},\events\right)$,
and the states consistent with $\iota_{n}\circ\mu_{\rho}^{\mathrm{B}}$
will become closer and closer to $\rho$.

If a QIVPM is not \emph{a priori} known to be induced by a state,
there are some QIVPMs that cannot be consistent with any state.

\begin{thm}[Non-extensible of Gleason's theorem to general QIVPMs]\label{thm:Non-extensible-of-Gleason's}In
a Hilbert space $\Hilb$ of dimension $3$, there is a QIVPM~$\bar{\mu}:\events\rightarrow\mathscr{I}$
such that $\coreBorn\left(\bar{\mu},\events\right)=\emptyset$.\end{thm}

\noindent Given an orthonormal basis $\left\{ \ket{0},\ket{1},\ket{2}\right\} $,
let $\mathscr{I}_{0}=\left\{ \necess,\imposs,\unknown\right\} $,
$\ket{\ps}=\left(\ket{0}+\ket{1}\right)/\sqrt{2}$, $\ket{\ps'}=\left(\ket{0}+\ket{2}\right)/\sqrt{2}$.
The function~$\bar{\mu}:\events\rightarrow\mathscr{I}_{0}$ defined
in Table~\ref{tab:non-Born-QIVPM} can be verified as a QIVPM straightforwardly.
\begin{table}
\caption{\label{tab:non-Born-QIVPM}Define a non-Born QIVPM~$\bar{\mu}:\events\rightarrow\mathscr{I}_{0}$
on the three-dimensional Hilbert space.}

\begin{tabular}{cc}
\toprule 
\addlinespace
$P$ & $\bar{\mu}\left(P\right)$\tabularnewline\addlinespace
\midrule
\midrule 
\addlinespace
$\mathbb{0}$, $\proj{0}$, $\proj{\ps}$, $\proj{\ps'}$ & $\imposs$\tabularnewline\addlinespace
\midrule 
\addlinespace
$\mathbb{1}$, $\mathbb{1}-\proj{0}$, $\mathbb{1}-\proj{\ps}$, $\mathbb{1}-\proj{\ps'}$ & $\necess$\tabularnewline\addlinespace
\midrule 
\addlinespace
All other projectors & $\unknown$\tabularnewline\addlinespace
\bottomrule
\end{tabular}
\end{table}
Next we will prove $\coreBorn\left(\bar{\mu},\events\right)$ is an
empty set by contradiction. Suppose there is a state $\rho=\sum_{j=1}^{N}q_{j}\proj{\phi_{j}}\in\coreBorn\left(\bar{\mu},\events\right)$,
where $\sum_{j=1}^{N}q_{j}=1$ and $q_{j}>0$. Since $\mu_{\rho}^{\mathrm{B}}(P)\in\bar{\mu}(P)$
for any~$P$, the state~$\rho$ must satisfy: 
\begin{equation}
\mu_{\rho}^{\mathrm{B}}(\proj{0})=\mu_{\rho}^{\mathrm{B}}(\proj{\ps})=\mu_{\rho}^{\mathrm{B}}(\proj{\ps'})=0\,,
\end{equation}
which implies $\ip{\phi_{j}}{0}=\ip{\phi_{j}}{\ps}=\ip{\phi_{j}}{\ps'}=0$
for all $j$. The last equation never holds proving the theorem. Thus,
there is no state consistent with the QIVPM on all projectors~$P\in\events$,
so Gleason's theorem cannot be extended to general QIVPMs.

Notice that if we restrict $\bar{\mu}$ on the commuting subspace
of events~$\events_{C}$, the state~$\frac{1}{2}\cdot\proj{1}+\frac{1}{2}\cdot\proj{2}\in\coreBorn\left(\bar{\mu},\events_{C}\right)$
so that $\coreBorn\left(\bar{\mu},\events_{C}\right)$ is non-empty.
In general, for any commuting subspace of events~$\events_{C}'$,
$\coreBorn\left(\bar{\mu},\events_{C}'\right)$ is non-empty according
to the classical Thm.~\ref{thm:Shapley}. The difference between
classical and quantum highlights the following fact: Although classically
we could build a theory and deal the finite-precision measurement
in error analysis, it is necessary to embed the finite-precision measurement
into the foundation of quantum theory.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusion}
\label{sec:Conclusion}
  
Foundational concepts in quantum mechanics, such as the Kochen-Specker
and Gleason theorems, rely in a very subtle way on the use of
unbounded resources. By assuming infinitely precise measurements,
these two insightful theorems underlie two fundamental aspects of
quantum mechanics. On the one hand, Kochen-Specker's result reveals a
distinctive aspect of physical reality, the fact that it is
contextual, and, on the other hand, Gleason's theorem establishes a
relationship between quantum states and probabilities uniquely defined
by Born's rule.  Our goal in this paper has been to analyze the
physical consequences of a mathematical framework that allows for
finite precision measurements by introducing the concept of quantum
interval-valued probability. This framework incorporates uncertainty
in the measurement results by defining fuzzy probability measures, and
includes standard quantum measurement as the particular instance of
sharp, infinitely precise, intervals.  In addition, we showed how
these two theorems emerge as limiting cases of this same framework,
thus connecting two seemingly unrelated aspects of quantum physics. We
noted that {\it arbitrary\/} finite precision measurement conditions
can nullify the main tenets of both theorems. However, by carefully
specifying experimental uncertainties, we were able to establish
rigorous bounds on the validity of these two theorems. Therefore, we
have established a context in which infinite precision quantum
mechanical theories can be reconciled with finite precision quantum
mechanical measurements, and have provided a possible resolution of
the Meyer-Mermin debate on the impact of finite precision on the
Kochen-Specker theorem~\cite{PhysRevLett.83.3751,Mermin1999}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliography{prop}
\end{document}

The similar kind of subtleties happens when we want to define the
expectation value of a random variable. Consider an event $E$ such
that $\bar{\mu}(E)=[0.2,0.3]$ and $\bar{\mu}(\overline{E})=[0.7,0.8]$.
Given a random variable
\begin{equation}
X\left(\omega\right)=\begin{cases}
1 & \textrm{, if }\omega\in E\textrm{ ;}\\
2 & \textrm{, if }\omega\notin E\textrm{ ,}
\end{cases}
\end{equation}
its expectation value with respect to $\bar{\mu}$ might be naïvely
defined as\begin{subequations}
\begin{eqnarray}
 &  & 1\cdot\bar{\mu}(E)+2\cdot\bar{\mu}(\overline{E})\\
 & = & 1\cdot[0.2,0.3]+2\cdot[0.7,0.8]\\
 & = & [1\cdot0.2+2\cdot0.7,1\cdot0.3+2\cdot0.8]\\
 & = & [1.6,1.9]\,.
\end{eqnarray}
\end{subequations}As we discussed in the previous paragraph, the
true probability of $\bar{\mu}(E)$, $\mu(E)$, can be anywhere in
the range $[0.2,0.3]$ and the true probability of $\bar{\mu}(\overline{E})$
is $\mu(\overline{E})=1-\mu(E)$. If $\mu(E)=0.2$, the expectation
value of $X$ with respect to $\mu$ is 
\begin{equation}
1\cdot\mu(E)+2\cdot\mu(\overline{E})=1\cdot0.2+2\cdot0.8=1.8\,;
\end{equation}
if $\mu(E)=0.3$, the expectation value of $X$ with respect to $\mu$
is
\begin{equation}
1\cdot\mu(E)+2\cdot\mu(\overline{E})=1\cdot0.3+2\cdot0.7=1.7\,.
\end{equation}
In another word, no matter how we pick $\mu(E)$, the expectation
value of $X$ is in $\left[1.7,1.8\right]$ which is a more realistic
expectation value of $X$ with respect to $\bar{\mu}$. The interval~$\left[1.7,1.8\right]$
is narrower than the naïve expectation value~$[1.6,1.9]$ because
the naïve one combines contradicting situations in the computation.
In general, the computation of the realistic expectation value, called
the Choquet integral, is more complex than what we discussed because
a random variable may have more than two values. Despite its complexity,
it is still a weight average among the values of a random variable
as given in the following definition.

\begin{definition}[Choquet integral~\citep{Vitali1925,Choquet1954,GilboaSchmeidler1994,Grabisch2016}]\label{def:Choquet}Consider
a classical IVPM~$\bar{\mu}$ such that $\mul:\events\rightarrow\left[0,1\right]$
and $\mur:\events\rightarrow\left[0,1\right]$ are the left-end and
the right-end of $\bar{\mu}$, respectively, i.e., $\bar{\mu}\left(E\right)=\left[\mul\left(E\right),\mur\left(E\right)\right]$.
We decompose a random variable~$X$ into step functions, but we separate
the positive and negative terms and write like
\begin{equation}
X=\sum_{s\in\left\{ +,-\right\} }\sum_{i=1}^{N^{s}}x_{i}^{s}\mathbf{1}_{E_{i}^{s}}\,,
\end{equation}
where $\mathbf{1}_{E_{i}^{s}}$ is the indicator function of $E_{i}^{s}$,
and we order the value of its range from the smallest to the largest
\begin{equation}
x_{N^{-}}^{-}\le\ldots\le x_{1}^{-}\le0\le x_{1}^{+}\le\ldots\le x_{N^{+}}^{+}
\end{equation}
 and $\left\{ E_{i}^{-}\right\} _{i=1}^{N^{-}}$ and $\left\{ E_{i}^{+}\right\} _{i=1}^{N^{+}}$
are all disjoint. Let $E_{i}^{s\prime}=\bigcup_{j\ge i}E_{j}^{s}$
and $\Delta\mu^{*}\left(E_{i}^{s\prime}\right)=\mu^{*}\left(E_{i}^{s\prime}\right)-\mu^{*}\left(E_{i+1}^{s\prime}\right)$,
where $s\in\left\{ +,-\right\} $ and $\mu^{*}\in\left\{ \mul,\mur\right\} $.
Then, the Choquet integral of $X$ with respect to $\bar{\mu}$ is
\begin{equation}
\int X\rmd\bar{\mu}=\sum_{s\in\left\{ +,-\right\} }\sum_{i=1}^{N^{s}}x_{i}^{s}\left[\Delta\mul\left(E_{i}^{s\prime}\right),\Delta\mur\left(E_{i}^{s\prime}\right)\right]\,.\label{eq:interval-expectation}
\end{equation}
\end{definition}

Although Def.~\ref{def:Choquet} looks complex, it matches with our
intuition in the previous example. Let
\begin{equation}
\mathrm{core}\left(\bar{\mu}\right)=\set{\pmeas:\events\rightarrow[0,1]}{\forall P\in\events.~\pmeas\left(P\right)\in\bar{\mu}\left(P\right)}\,,\label{eq:core}
\end{equation}
be the set of possible ``true'' probability measure of an IVPM~$\bar{\mu}$.
Then, the following theorem claims the expectation value of $\bar{\mu}$
is the range of the expectation value of the probability measure in
the core of $\bar{\mu}$.

\begin{thm}\label{thm:Rosenmuller}\citep{Rosenmuller1971,GilboaSchmeidler1994,Grabisch2016}~For
every classical IVPM~$\bar{\mu}:\events\rightarrow\mathscr{I}$ and
any random variable~$X:\Omega\rightarrow\mathbb{R}$, 
\begin{equation}
\int X\rmd\bar{\mu}=\left[\min_{\mu\in\mathrm{core}\left(\bar{\mu}\right)}\int X\rmd\mu,\max_{\mu\in\mathrm{core}\left(\bar{\mu}\right)}\int X\rmd\mu\right]\,.
\end{equation}
\end{thm}

%   To proceed, we use a formulation of the
% ``Mermin-Peres square''~\cite{peres1995quantum,Mermin1990Simple}
% that uses the expectation value of a physical observable with respect
% to a QIVPM, where the interval-valued expectation value is consistent
% with the expectation value of the same observable in conventional
% quantum mechanics with infinite resources. We show that, as long as
% errors and uncertainties remain smaller than a particular value, the
% Kochen-Specker theorem remains valid. In other words, we established a
% rigorous bound for its validity and, therefore, the limits for
% physical reality to remain contextual.

% \begin{thm} Given a Hilbert space $\Hilb$ of dimension~$d\ge3$,
% for every QIVPM~$\bar{\mu}:\events\rightarrow\mathscr{I}$, and an
% observable~$\mathbf{O}$ with its spectral decomposition~(\ref{eq:spectrum-decomposition}),
% let $\events'$ be the minimal subspace of events containing $\left\{ P_{i}^{-}\right\} _{i=1}^{N^{-}}\cup\left\{ P_{i}^{+}\right\} _{i=1}^{N^{+}}$,
% then 
% \begin{equation}
% \expval{\mathbf{O}}_{\bar{\mu}}=\left[\min_{\rho\in\coreBorn\left(\bar{\mu},\events'\right)}\expval{\mathbf{O}}_{\rho},\max_{\rho\in\coreBorn\left(\bar{\mu},\events'\right)}\expval{\mathbf{O}}_{\rho}\right]\,.\label{eq:quantum-interval-expectation-core}
% \end{equation}
% \end{thm}

After we defined QIVPMs, we can easily define the expectation value
of an observable with respect to a QIVPM by adopting the idea of the
classical Choquet integral. Notice that the quantum expectation value~(\ref{eq:quantum-expectation})
is the weight average among the eigenvalues with the weight~$\mu(P_{i})$.
Similarly, given a classical random variable~$X=\sum_{i=1}^{N}x_{i}\mathbf{1}_{E_{i}}$,
the expectation value of $X$ with respect to a probability measure~$\mu$
is the weight average among $x_{i}$ with the weight~$\mu(E_{i})$.
Since the definition of Choquet integral is just using a more complex
but reasonable way to compute the weight, we can apply the same algorithm
on an observable and get the following definition.

\begin{definition}Consider a QIVPM~$\bar{\mu}$ such that $\mul:\events\rightarrow\left[0,1\right]$
and $\mur:\events\rightarrow\left[0,1\right]$ are the left-end and
the right-end of $\bar{\mu}$, respectively, i.e., $\bar{\mu}\left(P\right)=\left[\mul\left(P\right),\mur\left(P\right)\right]$
for all $P\in\events$. This time, when we express the observable
as its spectral decomposition
\begin{equation}
\mathbf{O}=\sum_{s\in\left\{ +,-\right\} }\sum_{i=1}^{N^{s}}\lambda_{i}^{s}P_{i}^{s}\,,\label{eq:spectrum-decomposition}
\end{equation}
we separate the positive and negative eigenvalues and order its eigenvalues
from the smallest to the largest 
\begin{equation}
\lambda_{N^{-}}^{-}\le\ldots\le\lambda_{1}^{-}\le0\le\lambda_{1}^{+}\le\ldots\le\lambda_{N^{+}}^{+}\,.
\end{equation}
Let $P_{i}^{s\prime}=\sum_{j\ge i}P_{j}^{s}$ and $\Delta\mu^{*}\left(P_{i}^{s\prime}\right)=\mu^{*}\left(P_{i}^{s\prime}\right)-\mu^{*}\left(P_{i+1}^{s\prime}\right)$,
where $s\in\left\{ +,-\right\} $ and $\mu^{*}\in\left\{ \mul,\mur\right\} $.
Then, the expectation value of $\mathbf{O}$ with respect to $\bar{\mu}$
is defined as
\begin{equation}
\expval{\mathbf{O}}_{\bar{\mu}}=\sum_{s\in\left\{ +,-\right\} }\sum_{i=1}^{N^{s}}\lambda_{i}^{s}\left[\Delta\mul\left(P_{i}^{s\prime}\right),\Delta\mur\left(P_{i}^{s\prime}\right)\right]\,.\label{eq:quantum-interval-expectation}
\end{equation}
\end{definition}

If we define the multiplication of two singleton
sets~$\left\{ \lambda_{1}\right\} $ and $\left\{ \lambda_{2}\right\} $
to be $\left\{ \lambda_{1}\lambda_{2}\right\} $.

We will now adapt the proof above to show that it is, in general,
impossible to have just the two intervals \imposs\ and \necess: every
QIVPM must be parameterized by a collection of intervals that includes
at least one additional ``fuzzy'' interval and some events must be
associated with such uncertain intervals. The significance of this
observation is that the uncertainty in the intervals is, in contrast
to the classical case, \emph{a fundamental part of quantum
  theory}. There are in fact two sources of uncertainty: one due to
the finite measurement resources and one due to complementarity, which
requires every quantum framework to be truly probabilistic.

???~\cite{kochenspecker1967,peres1995quantum,Redhead1987-REDINA,Griffiths2003} 

